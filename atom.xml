<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Nihith&#39;s blog</title>
  <icon>https://www.gravatar.com/avatar/de1d76d2b7f3748eb7d97016b3d046bb</icon>
  <subtitle>CTF player &amp; Digital Forensics Analyst</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://bolisettynihith.github.io/"/>
  <updated>2020-10-21T10:50:04.471Z</updated>
  <id>https://bolisettynihith.github.io/</id>
  
  <author>
    <name>Nihith</name>
    <email>bolisettynihith@gmail.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PIP Install - Week 2 - Magnet Weekly CTF</title>
    <link href="https://bolisettynihith.github.io/Magnet-Weekly-CTF/PIP-Install-Week-2-Magnet-Weekly-CTF/"/>
    <id>https://bolisettynihith.github.io/Magnet-Weekly-CTF/PIP-Install-Week-2-Magnet-Weekly-CTF/</id>
    <published>2020-10-20T14:27:06.000Z</published>
    <updated>2020-10-21T10:50:04.471Z</updated>
    
    <content type="html"><![CDATA[<p>We are gonna use the Android Image that we examined last week for the “file that maps IPs to names recently accessed”. You can download the image <a href="https://drive.google.com/file/d/1tVTppe4-3Hykug7NrOJrBJT4OXuNOiDO/view?usp=sharing">here</a>.</p><p>Week 2 challenge is involved on applications capability and application usage. Let us get started!</p><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote><p>What domain was most recently viewed via an app that has picture-in-picture capability?</p></blockquote><p>For this weeks challenge, I am gonna use Alexis Brignoni’s <a href="https://github.com/abrignoni/ALEAPP">ALEAPP</a>.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>During the announcement of Week 2 challenge it was mentioned about a <a href="https://www.magnetforensics.com/resources/google-where-do-you-store-data-analysis-of-data-storage-between-android-and-google-takeout/">webinar</a> that Tarah Melton and Jessica Hyde had early this year on different data that can be found in Google Takeout and an Android Image. In the end of the webinar Jessica Hyde show us that, when we change an application the snapshots will be stored on the device.</p><p>And I found a site that <a href="https://nokiapoweruser.com/list-apps-support-oreo-picture-picture-mode-enable/">listed out all the applications</a> that supported Picture In Picture capability, and it turned out only a few have it.</p><h2 id="Firing-up-ALEAPP"><a href="#Firing-up-ALEAPP" class="headerlink" title="Firing up ALEAPP"></a>Firing up ALEAPP</h2><p>On firing Up ALEAPP, it creates a nice HTML report in the mentioned directory mentioned.</p><p><img src="aleapp.png" alt=""></p><p>On going through the reports generated by ALEAPP, it created a report for “Recent Activity, Snanpshots”. And the last accessed UPL from the browser according to the snapshot is <code>http://malliesae[.]com/investor-page/</code>. </p><p><img src="chrome_snapshot.jpg" alt=""></p><p><img src="snapshot.png" alt=""></p><p>From my personal experience, Chrome supports Picture In Picture capability, And on checking the Chrome History report generated by ALEAPP and sorting it out to most recently accessed URLs, it gave <code>http://malliesae[.]com/investor-page/</code> accessed at <code>2020-03-23 23:53:22</code></p><p><img src="chromehistory.png" alt=""></p><p>As chrome is having PIP capability and <code>malliesae[.]com</code> is the most recently accessed domain, let head on to submit it. And its correct!</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><blockquote><p><strong>malliesae.com</strong></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are gonna use the Android Image that we examined last week for the “file that maps IPs to names recently accessed”. You can download t
      
    
    </summary>
    
    
      <category term="Mobile Forensics" scheme="https://bolisettynihith.github.io/categories/Mobile-Forensics/"/>
    
    
      <category term="Magnet Weekly CTF" scheme="https://bolisettynihith.github.io/tags/Magnet-Weekly-CTF/"/>
    
      <category term="Android Forensics" scheme="https://bolisettynihith.github.io/tags/Android-Forensics/"/>
    
      <category term="ALEAP" scheme="https://bolisettynihith.github.io/tags/ALEAP/"/>
    
  </entry>
  
  <entry>
    <title>Mapping the Digits - Week 1 - Magnet Weekly CTF</title>
    <link href="https://bolisettynihith.github.io/Magnet-Weekly-CTF/Mapping-the-Digits-Week-1-Magnet-Weekly-CTF/"/>
    <id>https://bolisettynihith.github.io/Magnet-Weekly-CTF/Mapping-the-Digits-Week-1-Magnet-Weekly-CTF/</id>
    <published>2020-10-12T17:22:10.000Z</published>
    <updated>2020-10-21T10:19:29.249Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="description.png" alt=""></p><p>As the description says, we need to find the last modified time of a file that maps DNS names to IP’s recently accessed.</p><p>I don’t have much knowledge on Mobile Forensics. It is time to sharen my skills on Mobile Forensics. Magnet Forensics has decided for a weekly CTF, new challenge every Monday for the last quarter of 2020. You can find more info in the <a href="https://www.magnetforensics.com/blog/magnet-weekly-ctf-challenge/">blog post</a> released by Magnet Forensics.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>With my limited experience in Mobile Forensics, I started to look for <strong>hosts</strong> file as it is responsible for mapping IP’s to DNS names(Similar to Windows and Linux).</p><p>Let’s go a head and load the Android Image in Autopsy. You can download the image <a href="https://drive.google.com/file/d/1tVTppe4-3Hykug7NrOJrBJT4OXuNOiDO/view?usp=sharing">here</a>. </p><p>If you don’t know how to load an Android Image in autopsy, found this <a href="https://www.digitalforensics.com/blog/forensic-analysis-of-an-android-logical-image-with-autopsy/">blog post</a> and followed that and loaded the image in Autopsy.</p><p>After loading the android image in autopsy, on checking the files present on the device, I found something intersting in Downloads folder(<code>/data/media/0/Download</code>).</p><p><img src="autopsy_downloads.png" alt=""></p><p>This seems to the required hosts file, Normally it won’t be stored in any local folder, So to confirm I searched for the hosts file location in android device.</p><h2 id="Retrieving-hosts-file"><a href="#Retrieving-hosts-file" class="headerlink" title="Retrieving hosts file"></a>Retrieving hosts file</h2><p>Upon seaching for the hosts file location, got hit, saying that it will be stored in <code>/device/system/etc/system</code>.</p><p><img src="hosts_location_net.png" alt=""></p><p>When I checked it, etc folder is not there in the mentioned location.</p><p><img src="system_etc_system.png" alt=""></p><p>Upon searching and got an another hit saying that it will be stored in <code>adb</code> folder of the image. </p><blockquote><p>Location: /adb/modules/hosts/system/etc/hosts</p></blockquote><p><img src="adb.png" alt=""></p><p>In the same way I am not able to view the metadata on Autopsy for that file.</p><p>As I have extracted the tar file, I went to that location and viewed the metadata of that file.</p><p><img src="metadata_hosts.png" alt=""></p><p>Upon converting the timestamp <code>‎05 ‎March ‎2020, ‏‎11.20.18 AM</code> from IST to UTC, we get <code>‎05 ‎March ‎2020, ‏‎05.50.18 AM</code></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><blockquote><p>03/05/2020 05:58:18</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Description&quot;&gt;&lt;a href=&quot;#Description&quot; class=&quot;headerlink&quot; title=&quot;Description&quot;&gt;&lt;/a&gt;Description&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;description.png&quot; alt=&quot;&quot;&gt;
      
    
    </summary>
    
    
      <category term="Mobile  Forensics" scheme="https://bolisettynihith.github.io/categories/Mobile-Forensics/"/>
    
    
      <category term="Autopsy" scheme="https://bolisettynihith.github.io/tags/Autopsy/"/>
    
      <category term="Magnet Weekly CTF" scheme="https://bolisettynihith.github.io/tags/Magnet-Weekly-CTF/"/>
    
      <category term="Android Forensics" scheme="https://bolisettynihith.github.io/tags/Android-Forensics/"/>
    
  </entry>
  
  <entry>
    <title>DB64 - Poseidon CTF</title>
    <link href="https://bolisettynihith.github.io/DB64-Poseidon-CTF/"/>
    <id>https://bolisettynihith.github.io/DB64-Poseidon-CTF/</id>
    <published>2020-08-19T12:37:09.000Z</published>
    <updated>2020-08-19T17:51:06.128Z</updated>
    
    <content type="html"><![CDATA[<p>I have solved this challenge after the CTF. </p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are given with a windows 7 memory dump, lets start out initial analysis and check what all processes are running.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre><p><img src="pslist.png" alt="Process list"></p><p>We can see that <code>Google Chrome</code> and <code>Command Prompt</code> are active running process. So let us dig more into them and check whats there in them.</p><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As we know each and every command we entered in command prompt are stored in conhost.exe and we can retrive those commands from volatility’s <code>consoles</code> plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 consoles</code></pre><p><img src="/images/consoles.png" alt="consoles"></p><p>We can see “<code>I cant paste the binary in recyle bin</code>“ which gives us an information that we have to proceed to <code>pastebin</code> for the next step. But we need a random 8 letter character.</p><p>On going through some plugins, used <code>mimikatz</code> to get the user password. And found something similar to that random 8 letter character for pastebin.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 mimikatz</code></pre><p><img src="mimikatz.png" alt="mimikatz"></p><p>So on proceeding to this pastebin link(<a href="https://pastebin.com/dVi29Tv8">https://pastebin.com/dVi29Tv8</a>) and we can see a lot of strings of length 37. So it much be some kind of wordlist or something.</p><p>Let us check whats there in chrome history.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 chromehistory</code></pre><p><img src="chromehistory.png" alt="chrome history"></p><p>We can see that there is drive link(<a href="https://drive.google.com/file/d/1jYpvi9Va8be022G1SL4xUpEmZoknveTd/view">https://drive.google.com/file/d/1jYpvi9Va8be022G1SL4xUpEmZoknveTd/view</a>) is present and after opening it we found an <code>keepass</code> database.</p><p>For opening these keepass database we need a <code>Master Password</code> or <code>Key file</code>. But we can’t find one in the given memory, so as we know we can crack Keepass passwords with John the ripper and get the password if we have the correct wordlist.</p><p>Using the strings found in the pastebin as a wordlist we got the password.</p><p><img src="john_keepass.png" alt="John load hash"></p><p><img src="john_crack.png" alt="John Crack"></p><p>As I have already loaded the hash and its showed its already cracked. And we can see the cracked hashes also and we got the password as this <code>guz6AP41eXNZN6alCTZQsytzYsDSWrUV45lp</code> and after opening the keepass with that password we can see so many passwords already there in the database. From the username we can see that <code>Pastebin/KEY</code>. And the passwords are also something similar to 8 letter random characters needed for pastebin.</p><p><img src="keypass.png" alt="Keypass"></p><p>After going through them and we can see a long base64 string in all the pastebins and decoding those base64 strings and there are a lot of fake flag and in that one them is flag.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><img src="flag.png" alt="flag"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;I have solved this challenge after the CTF. &lt;/p&gt;
&lt;h2 id=&quot;Initial-Analysis&quot;&gt;&lt;a href=&quot;#Initial-Analysis&quot; class=&quot;headerlink&quot; title=&quot;Initial 
      
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Memory Forensics" scheme="https://bolisettynihith.github.io/categories/Writeups/Memory-Forensics/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Keepass" scheme="https://bolisettynihith.github.io/tags/Keepass/"/>
    
  </entry>
  
  <entry>
    <title>Lookout Foxy - InCTF Internationals 2020</title>
    <link href="https://bolisettynihith.github.io/InCTFi20-LookoutFoxy/"/>
    <id>https://bolisettynihith.github.io/InCTFi20-LookoutFoxy/</id>
    <published>2020-08-03T11:22:56.000Z</published>
    <updated>2020-10-20T18:37:42.591Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Decrypt the encrypted GPG file found in Outlook Express with the private key stored on the device.</li><li>Decrypt the firefox saved passwords and log in to the website that the terrorist used.</li></ul><a id="more"></a><p><strong>Challenge points</strong>: 627<br><strong>No. of solves</strong>: 30<br><strong>Challenge Author</strong>: <a href="https://twitter.com/NihithNihi">g4rud4</a></p><h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/LookoutFoxy/description.png" alt="Description"></p><p>You can download the challenge file from <a href="https://mega.nz/folder/MgtBHIhL#ChC7QdsEESP6_O-aALDSvw"><strong>Mega</strong></a> or <a href="https://drive.google.com/drive/folders/1EICM8RCZB4jHm63M6Y2Dua2Ir8zOaj5B?usp=sharing"><strong>Google Drive</strong></a></p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with an E01 file(Expert  Witness format image). There are a lot of ways in analyzing these files, I choose to use Autopsy for analyzing this. Let’s go ahead and load our E01 file in Autopsy. You can visit Autopsy’s<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> documentation if you don’t know how to add a data source to autopsy.</p><p>From the description, we have a clue that the terrorist is using a <strong>genuine chat client</strong>, lets see what all applications are installed in the device.</p><p>As we know, all the applications present on the device can be found in <code>Program Files</code>. Some of the applications we need to check are <code>GPG</code>, <code>Mozilla Firefox</code>, <code>NetMeeting</code>, <code>Outlook Express</code>. Let us dig more into it and check if they have identified and configured.</p><p><img src="/images/LookoutFoxy/applications.png" alt="applications"></p><p>So by checking application data, we can say that <code>Outlook Express</code> and <code>Mozilla Firefox</code> are configured. Let us dig more into them.</p><h2 id="First-part-solution"><a href="#First-part-solution" class="headerlink" title="First part solution"></a>First part solution</h2><p>As the Outlook Express is configured on the device, it leaves us useful forensics artifacts on the device.</p><p><img src="/images/LookoutFoxy/application_data.png" alt="application data"></p><p>Some of them are the mails received and sent. Whenever we receive a mail or delete a mail or sent a mail it will be stored in a <strong>.dbx files</strong>. Ex: for Inbox Emails - <code>inbox.dbx</code>, Sent Emails - <code>outbox.dbx</code> etc.</p><p>These files are stored at <code>C:\Documents and Settings\Crimson\Local Settings\Application Data\Identities\{random characters}\Microsoft\Outlook Express\</code></p><p>In our case, these are stored at <code>C:\Documents and Settings\Crimson\Local Settings\Application Data\Identities\{72F33BC6-0035-4FE0-AED1-5870C5CA389E}\Microsoft\Outlook Express\</code></p><p><img src="/images/LookoutFoxy/outlook_files.png" alt="Outlook Express files"></p><p>You can see .dbx files being listed there on right. We know that we can’t view the messages stored in <strong>DBX</strong> files. So I have converted the DBX file into a PDF file using this <a href="https://www.coolutils.com/online/DBX-to-PDF"><strong>link</strong></a>. There are other ways too, as this gives us something similar to the GUI, I used this. And one of the best thing is to do <code>strings</code> on the DBX files.</p><p>Converting the <code>Inbox.dbx</code> to PDF, One will be able to see that there is a mail from <code>David Banjamin davin.banjamin@gmail.com</code> with a subject <code>Secret File</code>. And a file named <code>secret.gpg</code> has been attached.</p><p><img src="/images/LookoutFoxy/inbox.png" alt="Outlook_Inbox"></p><p>We can get this file by a simple keyword search in Autopsy or check below.</p><p>So these attached files are stored in this location, unless the user saved it into a specified location <code>C:\Users\{username}\AppData\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5\{random characters}</code>.</p><p>We have 4 directories listed there, so rather than traversing through all directories, I used Autopsy’s <code>Web Downloads</code> Result. There we can see that there is a <code>secret.gpg.Zone.identifier</code> file. These <strong>Zone identifier</strong> files are generated automatically by applications/programs when files are downloaded to a Windows computer. So by checking the <code>Source file path</code> we can get the random characters. So going into that directory(<code>U0PDHEH3</code>), we can get the <code>secret.gpg</code> file easily.</p><p><img src="/images/LookoutFoxy/web_downloads.png" alt="Web Downloads Autopsy"></p><p><img src="/images/LookoutFoxy/temintfil.png" alt="Temporory internet files - secret.gpg"></p><p>We know that the gpg files can only be decrypted by the Owner’s private key. As we have seen a directory named <code>GPG</code> while traversing through the program files. Going into this directory we can find the <code>secret.key</code>.</p><p>Importing the private key and decrypting the encrypted GPG file, we can get the first half of the flag.</p><p><img src="/images/LookoutFoxy/gpg_import.png" alt="GPG Import"></p><pre class=" language-bash"><code class="language-bash">$ gpg --decrypt secret.gpg</code></pre><p>Snipping the output,</p><p><img src="/images/LookoutFoxy/firsthalfflag.png" alt="First half flag"></p><p>First half: <strong>inctf{!<strong>h0p3_y0u_L1k3d_s0lv1ng_7h3_F1rs7_p4r7</strong></strong></p><h2 id="Second-part-solution"><a href="#Second-part-solution" class="headerlink" title="Second part solution"></a>Second part solution</h2><p>As we see that there are a lot of web searches listed out in <code>Web History</code> results in Autopsy and going through them we can see a suspicious link <strong><a href="http://35.209.205.103/">http://35.209.205.103/</a></strong> in the history. So going to that link there is a login page. And there is a note saying <strong>Don’t brutefore the Password</strong>. So the password must be saved somewhere.</p><p><img src="/images/LookoutFoxy/login.png" alt="login"></p><p>As the terrorist is using firefox. And an active firefox installation will have a profile(in our case - <strong>5ztdm4br.default</strong>) which consists of a lot of forensics artifacts and that can be found generally at </p><blockquote><p><strong>Path</strong>: <code>C:\Documents and Settings\{Username}\Application Data\Mozilla\Firefox\{random characters}.default\</code></p></blockquote><p>In our case, these are found at</p><blockquote><p><strong>Path</strong>: <code>C:\Documents and Settings\Crimson\Application Data\Mozilla\Firefox\5ztdm4br.default\</code></p></blockquote><p>By Checking the <code>Web Form Autofill</code> results in Autopsy or by looking at the <strong>formhistory.sqlite</strong> database present in the firefox profile, we were able to see that the username as <strong>Danial_Banjamin</strong> and we need to find out the password.</p><p>As the username and password are stored in formhistory, that means passwords are stored in firefox saved passwords. We need to decrypt the saved passwords to get the original password.</p><p>Here comes the interesting part of decrypting Firefox saved passwords. There are a lot of ways</p><ol><li>By dumping the whole profile and passing the dumped folder location to firepwd<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> and a lot more.</li><li>By dumping only the required files from the profile.</li></ol><p>I am choosing the second way and here are those files:</p><ol><li><p><strong>logins.json</strong> - Place where all login information such as encrypted username and password are stored.</p></li><li><p><strong>cert8.db</strong> and <strong>key3.db</strong>/<strong>key4.db</strong> - These are encrypted SQLite database files, and the entries <code>encryptedUsername</code> and <code>encryptedPassword</code> found in logins.json are encrypted with the keys found in both databases.</p></li><li><p><strong>Permissions.sqlite</strong> - It contains permissions for installing add-ons, cookies, etc.</p></li></ol><p>After dumping all these files from the firefox profile mentioned above, I used <code>pwdecrypt</code> to decrypt the password. It’s a Debian package and can be installed by with apt.</p><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> apt <span class="token function">install</span> libnss3-tools</code></pre><p>Then, I used a JSON parser(<code>jq</code>) to parse the JSON file and redirected the output to pwdecrypt.</p><p>Here is the json parsed output of logins.json.</p><pre class=" language-bash"><code class="language-bash">$ jq <span class="token keyword">.</span> <span class="token operator">&lt;</span> logins.json<span class="token punctuation">{</span>  <span class="token string">"nextId"</span><span class="token keyword">:</span> 3,  <span class="token string">"logins"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      <span class="token string">"id"</span><span class="token keyword">:</span> 2,      <span class="token string">"hostname"</span><span class="token keyword">:</span> <span class="token string">"http://35.209.205.103"</span>,      <span class="token string">"httpRealm"</span><span class="token keyword">:</span> null,      <span class="token string">"formSubmitURL"</span><span class="token keyword">:</span> <span class="token string">"http://35.209.205.103"</span>,      <span class="token string">"usernameField"</span><span class="token keyword">:</span> <span class="token string">"username"</span>,      <span class="token string">"passwordField"</span><span class="token keyword">:</span> <span class="token string">"password"</span>,      <span class="token string">"encryptedUsername"</span><span class="token keyword">:</span> <span class="token string">"MDoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECOczOqq7/ZDYBBC7w84JwpxUfkx1Nw52VKlx"</span>,      <span class="token string">"encryptedPassword"</span><span class="token keyword">:</span> <span class="token string">"MFoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECCwD7aXJGN+hBDAmr4dSU/2vXn+H+TZDl+oTlLGPMbX4usiAkneTan114d6kB2GGUa2b6771U5YIU40="</span>,      <span class="token string">"guid"</span><span class="token keyword">:</span> <span class="token string">"{3ff55df0-bbb8-4192-98df-a1f428964c31}"</span>,      <span class="token string">"encType"</span><span class="token keyword">:</span> 1,      <span class="token string">"timeCreated"</span><span class="token keyword">:</span> 1595695030340,      <span class="token string">"timeLastUsed"</span><span class="token keyword">:</span> 1595858974764,      <span class="token string">"timePasswordChanged"</span><span class="token keyword">:</span> 1595695030340,      <span class="token string">"timesUsed"</span><span class="token keyword">:</span> 2    <span class="token punctuation">}</span>  <span class="token punctuation">]</span>,  <span class="token string">"disabledHosts"</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,  <span class="token string">"version"</span><span class="token keyword">:</span> 2<span class="token punctuation">}</span></code></pre><p>As we are having so many entries, and we only need the username, password and URL. So added those entries to json parser and redirected it to <strong>pwdecrypt</strong>.</p><pre class=" language-bash"><code class="language-bash">$ jq -r -S <span class="token string">'.logins[] | .hostname, .encryptedUsername, .encryptedPassword'</span> logins.json <span class="token operator">|</span> pwdecrypt -d <span class="token keyword">.</span>http://35.209.205.103Decrypted: <span class="token string">"Danial_Banjamin"</span>Decrypted: <span class="token string">"2!6BQ&amp;e626g#YNWxsQWV9^knO8#85*E%6Zaxr@At42"</span></code></pre><p>As the master password was not set by the terrorist we were able to get the decrypted password. So logging in using those credentials gives the second part of the flag.</p><p><img src="/images/LookoutFoxy/second_part.png" alt="second part"></p><p>Second Part of the flag: <strong>4nd_3njoy3d_7he_53c0nd_p4rt_0f_7h3_ch4ll3ng3}</strong></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>By concatinating two parts, here is the final flag:<br><strong>inctf{!_h0p3_y0u_L1k3d_s0lv1ng_7h3_F1rs7_p4r7_4nd_3njoy3d_7he_53c0nd_p4rt_0f_7h3_ch4ll3ng3}</strong></p><p>If you have any queries, Feel free to ping me. I am available on Twitter <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>Here are some of the resources I came up while making the challenge. Hope it will be useful.</p><ul><li><a href="https://blog.tajuma.com/?p=35">https://blog.tajuma.com/?p=35</a></li><li><a href="http://raidersec.blogspot.com/2013/06/how-browsers-store-your-passwords-and.html">http://raidersec.blogspot.com/2013/06/how-browsers-store-your-passwords-and.html</a></li><li><a href="http://media.blackhat.com/bh-us-11/Bursztein/BH_US_11_Bursztein_Owade_Slides.pdf">http://media.blackhat.com/bh-us-11/Bursztein/BH_US_11_Bursztein_Owade_Slides.pdf</a></li></ul><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">https://sleuthkit.org/autopsy/docs/user-docs/4.3/ds_page.html</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">https://github.com/lclevy/firepwd</span><a href="#fnref:2" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Decrypt the encrypted GPG file found in Outlook Express with the private key stored on the device.&lt;/li&gt;
&lt;li&gt;Decrypt the firefox saved passwords and log in to the website that the terrorist used.&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Forensics" scheme="https://bolisettynihith.github.io/categories/Forensics/"/>
    
      <category term="Disk" scheme="https://bolisettynihith.github.io/categories/Forensics/Disk/"/>
    
    
      <category term="Autopsy" scheme="https://bolisettynihith.github.io/tags/Autopsy/"/>
    
      <category term="InCTFi" scheme="https://bolisettynihith.github.io/tags/InCTFi/"/>
    
  </entry>
  
  <entry>
    <title>USB 2 - 2020 Defenit CTF</title>
    <link href="https://bolisettynihith.github.io/Defenit20-USB2/"/>
    <id>https://bolisettynihith.github.io/Defenit20-USB2/</id>
    <published>2020-06-07T17:18:20.000Z</published>
    <updated>2020-08-19T13:42:50.889Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Digging into windows registry to find process run counts and when it was run.</li><li>Extracting and parsing AmCache to find the hash of process images</li></ul><a id="more"></a><p>I have solved this challenge along with my teammate <a href="https://twitter.com/_abhiramkumar">stuxn3t</a> during the Defenit CTF.</p><h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/Defenit20-USB2/description.png" alt="Challenge-Description"></p><p>The challenge file can be downloaded from <a href="https://drive.google.com/drive/folders/1xWIDVxxr6gGL6w-7K2KNwDmanADfKMDW">Google Drive</a>.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with the file <code>usb.ad1</code>. From the extension, It was quite clear that the evidence was acquired via Access Data’s FTK Imager. So let us go ahead and load the file in FTK Imager with version &gt;=4.2.0.</p><p>We observe that only very few directories are present and our objective is to find the answer to the following questions so that we can combine them to get the flag. So let us dig in.</p><h2 id="Solution-for-Question-1"><a href="#Solution-for-Question-1" class="headerlink" title="Solution for Question 1"></a>Solution for Question 1</h2><pre class=" language-text"><code class="language-text">Question 1: Among the exe files, there are several files executed on the same USB. Let's call the second executed file 'A'. What is the name of 'A'?</code></pre><p>From the question we are clear that, we need to find what all processes were run when the USB was pluged in. As the system records all the events, we can look event logs and registry analysis.</p><p>However, we found the presence of <code>NTUSER.DAT</code> in the system. As the <code>NTUSER.dat</code> stores the software and operating system settings for each user profile. One can find <code>NTUSER.dat</code> in his user directory <code>[root]/Users/james</code></p><p><img src="/images/Defenit20-USB2/ntuser.png" alt="NTUSER.dat"></p><p>There are a lot of tools to view registry files. Here I am using Eric Zimmerman’s <strong>Registry Explorer</strong>.</p><p>In <code>NTUSER.data</code>, <code>UserAssist</code> is the registry key that stores the list of processes that were run, when it was run, how many times it was run. We can find all those values from this sub-key according to our system:</p><pre class=" language-text"><code class="language-text">Path: Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count</code></pre><p><img src="/images/Defenit20-USB2/userassist.png" alt="UserAssist"></p><p>To know which process was run on the USB, we first need to find when was the USB plugged in. For this, we use the <code>SYSTEM</code> registry to determine the <code>USB Last Arrival Date</code> time of the USB on the system. And that can be found from this sub-key:</p><pre class=" language-text"><code class="language-text">Path: ControlSet001\Enum\USBSTOR\Disk&Ven_SanDisk&Prod_Ultra&Rev_1.00\4C531001461206123040&0\Properties\{83da6326-97a6-4088-9453-a1923f573b29}\0066</code></pre><p><img src="/images/Defenit20-USB2/lastwrittentime.png" alt="Last Written time"></p><p>We can see the last write time as <code>2020-05-17 18.15.13</code>. So from this small detail, we can easily eliminate a lot of processes. However, we also found out that the USB was plugged-in/used ~ 18:00 Hrs as well. We found this from the <code>.lnk</code> files created in the system.</p><p><img src="/images/Defenit20-USB2/recentapps.png" alt="RecentApps"></p><p><code>.lnk</code> files are created whenever a file/folder is opened. In this case, we find a <strong>USB (E).lnk</strong> created on <code>2020-05-17 19:11:36 Hrs</code>.</p><p>So we can now identify the process. As we need to locate only 2 processes closest to this timestamp and the second one is the answer. On observing closely, we can see 2 processes are nearer to thae above timestamp.</p><table><thead><tr><th align="center">Program Name</th><th align="center">Run Counter</th><th align="center">Focus Count</th><th align="center">Focus Time</th><th align="center">Last Executed</th></tr></thead><tbody><tr><td align="center">E:\svchost.exe</td><td align="center">1</td><td align="center">0</td><td align="center">0d, 0h, 00m, 00s</td><td align="center">2020-05-17 19:11:00</td></tr><tr><td align="center">Microsoft.Windows.Explorer</td><td align="center">40</td><td align="center">109</td><td align="center">0d, 0h, 53m, 03s</td><td align="center">2020-05-17 19:10:13</td></tr></tbody></table><p>On looking the timestamps given by processes, I chose <code>svchost.exe</code></p><h2 id="solution-for-Question-2"><a href="#solution-for-Question-2" class="headerlink" title="solution for Question 2"></a>solution for Question 2</h2><pre><code>Question 2: How many times has &#39;A&#39; been executed?</code></pre><p>Since we have determined the which process is ‘A’ (svchost.exe), from the above table, we can get the answer to this question from the value specified in the <code>Run Counter</code> column, we can see that the svchost.exe was run <code>1</code> time.</p><h2 id="Solution-for-Question-3"><a href="#Solution-for-Question-3" class="headerlink" title="Solution for Question 3"></a>Solution for Question 3</h2><pre><code>Question 3: What is the sha-1 hash value of &#39;A&#39;?</code></pre><p>As we need the SHA-1 hash of <code>svchost.exe</code>, we can get the sha-1 hash from Sysmon records. As its not been enabled, we can get those details from the <code>Amcache.hve</code> file. Along with the SHA-1 hash, from the Amcahe.hve, we can also get recent processes that were run and lists the path of the files that’s executed which can then be used to find the executed program. Luckily, this file was present in the system.</p><p><strong>Path</strong>: <code>\%SystemRoot%\AppCompat\Programs\Amcache.hve</code></p><p>We can use Eric Zimmerman’s tool <a href="https://f001.backblazeb2.com/file/EricZimmermanTools/AmcacheParser.zip">AmcacheParser</a> to parse the files.</p><p>We extract the following files</p><ul><li>Amcache.hve</li><li>Amcache.hve.LOG1</li><li>Amcache.hve.LOG2</li></ul><p>Next, we powerup the PowerShell to properly parse the files into <code>.CSV</code> format.</p><p><img src="/images/Defenit20-USB2/amcache.png" alt="amcache"></p><p>The excel file required in this case is the <code>Amcache_UnassociatedFileEntries.csv</code>.</p><p><img src="/images/Defenit20-USB2/excel.png" alt="excel"></p><p>So we now have the SHA-1 hash of the file as: <code>d68960b8ecb374dd98ef6a33fed45dddd9796402</code></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>By concatenating all the 3 answers gives us the flag.</p><p><strong>FLAG</strong>: <code>Defenit{svchost.exe_1_d68960b8ecb374dd98ef6a33fed45dddd9796402}</code></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/">https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Digging into windows registry to find process run counts and when it was run.&lt;/li&gt;
&lt;li&gt;Extracting and parsing AmCache to find the hash of process images&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Windows Registry Analysis" scheme="https://bolisettynihith.github.io/categories/Writeups/Windows-Registry-Analysis/"/>
    
    
      <category term="Registry Analysis" scheme="https://bolisettynihith.github.io/tags/Registry-Analysis/"/>
    
      <category term="Amcache" scheme="https://bolisettynihith.github.io/tags/Amcache/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 6 writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-6-writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-6-writeup/</id>
    <published>2020-06-01T06:36:12.000Z</published>
    <updated>2020-07-18T05:12:04.024Z</updated>
    
    <content type="html"><![CDATA[<p>We are provided with a <strong>Windows 7</strong> memory dump. Let us begin our initial level of analysis.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><pre><code>$ volatility -f MemoryDump_Lab6.raw --profile=Win7SP1x64 pslist</code></pre><p><img src="/images/Memlabs-Lab-6/pslist1.png" alt="pslist"><br><img src="/images/Memlabs-Lab-6/pslist2.png" alt="pslist"></p><p>As we see from the process list, <code>cmd.exe</code>, <code>chrome.exe</code>, <code>firefox.exe</code> and <code>WinRAR.exe</code> as active running processes.</p><h2 id="First-part"><a href="#First-part" class="headerlink" title="First part"></a>First part</h2><p>Let us check the chrome’s history.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile<span class="token operator">=</span>Win7SP1x64 chromehistory</code></pre><p><img src="/images/Memlabs-Lab-6/pastebin1.png" alt="chromehistory"></p><p>This seem to be an interesting <a href="https://pastebin.com/RSGSi1hk">pastebin</a> link.</p><p><img src="/images/Memlabs-Lab-6/pastebin2.png" alt="PasteBin"></p><p>The Pastebin link contains another Google Docs link, lets head there. The docs link is: <a href="https://www.google.com/url?q=https://docs.google.com/document/d/1lptcksPt1l_w7Y29V4o6vkEnHToAPqiCkgNNZfS9rCk/edit?usp%3Dsharing&sa=D&source=hangouts&ust=1566208765722000&usg=AFQjCNHXd6Ck6F22MNQEsxdZo21JayPKug">click here</a></p><p><img src="/images/Memlabs-Lab-6/mega_link.png" alt="Google-Doc"></p><p>The doc contains a lot of spam but there is one interesting link which leads us to a mega drive: <strong><a href="https://mega.nz/#!SrxQxYTQ">https://mega.nz/#!SrxQxYTQ</a></strong>.</p><p>However, to download the file present in the mega drive, we need to find the KEY. However, the text in the Pastebin link tells us that “David sent the key in mail”.</p><p>Okay, let me use the <code>Screenshot</code> plugin, it might help us.</p><pre><code>$ volatility --plugins=/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile=Win7SP1x64 screenshot -D .</code></pre><p><img src="/images/Memlabs-Lab-6/screenshot.png" alt="Screenshot"></p><p>We can see that firefox window is open with the Gmail and has a subject <strong>Mega Drive Key</strong>. Now its time for some raw analysis. As the browser data is stored in JSON files. So we might get the message attached to that subject from raw analysis.</p><p>So we can use the <code>strings</code> command, as we can get the data stored in JSON file from the memory.</p><pre class=" language-bash"><code class="language-bash">$ strings MemoryDump_Lab6.raw <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Mega Drive Key"</span></code></pre><p><img src="/images/Memlabs-Lab-6/mega_key.png" alt="strings"></p><p>So the key is <strong>zyWxCjCYYSEMA-hZe552qWVXiPwa5TecODbjnsscMIU</strong>.</p><p>So we find a PNG image in the Mega drive. However, PNG is corrupted. Fixing the IHDR of the image gives us the 1st part of the flag.</p><p><img src="/images/Memlabs-Lab-6/flag1.png" alt="flag 1stpart"></p><p>The first part is: <strong>inctf{thi5_cH4LL3Ng3_!s_g0nn4_b3_?_</strong></p><h2 id="Second-part"><a href="#Second-part" class="headerlink" title="Second part"></a>Second part</h2><p>As WinRAR is running, that imply that user opened a rar archive, So we will search for a <code>rar archive</code> in the memory.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile<span class="token operator">=</span>Win7SP1x64 filescan <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">rar</span></code></pre><p>we see a folder named <strong>pr0t3ct3d</strong> and which contains a RAR archive with the name <strong>flag.rar</strong></p><p><img src="/images/Memlabs-Lab-6/filescan_rar.png" alt="filescan"></p><p>Let us dump the RAR archive with the help of the dumpfiles plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000005fcfc4b0 -D <span class="token keyword">.</span></code></pre><p><img src="/images/Memlabs-Lab-6/dump_rar.png" alt="Dump Rar"></p><p>However, the archive is password protected. Also, brute-forcing for the password might not help us. So lets check the other running processes.</p><p>As <code>cmd.exe</code> is running, Using the <code>cmdscan</code> plugin, we see that <code>env</code> command has been used. So let us look at the Environment variables.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile<span class="token operator">=</span>Win7SP1x64 cmdscan</code></pre><p><img src="/images/Memlabs-Lab-6/cmdscan.png" alt="cmdscan"></p><pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab6.raw --profile<span class="token operator">=</span>Win7SP1x64 envars</code></pre><p>We observe a custom variable created named <strong>RAR password</strong>.</p><p><img src="/images/Memlabs-Lab-6/envars.png" alt="envars"></p><p>So it gives out the password as <strong>easypeasyvirus</strong>. Now we get the last part of the flag.</p><p><img src="/images/Memlabs-Lab-6/flag2.png" alt="flag2"></p><p>So now let us concatenate the 2 parts to finish this lab.</p><p>FLAG: <strong>inctf{thi5_cH4LL3Ng3_!s_g0nn4_b3_?<em>aN_Am4zINg</em>!<em>i</em>gU3Ss???_}</strong></p><p><strong>Note:</strong> Due to some markdown issue, ‘_’ is not being displayed properly, so check it out.</p><p>That’s how you finish this <strong>MemLabs, Lab – 6</strong>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are provided with a &lt;strong&gt;Windows 7&lt;/strong&gt; memory dump. Let us begin our initial level of analysis.&lt;/p&gt;
&lt;h2 id=&quot;Initial-Analysis&quot;&gt;
      
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 5 writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-5-writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-5-writeup/</id>
    <published>2020-06-01T06:35:12.000Z</published>
    <updated>2020-07-18T05:13:17.123Z</updated>
    
    <content type="html"><![CDATA[<p>We are provided with a <strong>Windows 7</strong> memory dump. Let us begin our initial level of analysis.</p><p>Let’s start with the running processes.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab5.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre><p><img src="/images/Memlabs-Lab-5/pslist1.png" alt="pslist output"><br><img src="/images/Memlabs-Lab-5/pslist2.png" alt="pslist output"></p><p>As we can <code>WinRAR.exe</code> is running, that imply that the user might opened a RAR archive. So lets check for a RAR file in the whole memory.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab5.raw --profile<span class="token operator">=</span>Win7SP1x64 filescan <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">rar</span></code></pre><p><img src="/images/Memlabs-Lab-5/filescan_rar.png" alt="Rar"></p><p>As we can see that there is a rar archive present in the memory. So lets dump it and check it.</p><p><img src="/images/Memlabs-Lab-5/dump_rar.png" alt="dumpfiles"></p><p>We have dumped the rar. Let us check extracting it and check the contents present in it.</p><p><img src="/images/Memlabs-Lab-5/unrar1.png" alt="extract rar"><br>As we can see that, it is asking for the password. And the description says that <code>You&#39;ll get the stage 2 flag only when you have the stage 1 flag</code>. So let us find the first flag.</p><h2 id="Flag-1"><a href="#Flag-1" class="headerlink" title="Flag 1"></a>Flag 1</h2><p>As we seen the pslist output, we can’t find any suspicious process running. So lets check the explorer history. For this we will use <code>iehistory</code> plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab5.raw --profile<span class="token operator">=</span>Win7SP1x64 iehistory</code></pre><p><img src="/images/Memlabs-Lab-5/iehistory.png" alt="iehistory"></p><p>We can see a bmp file being accessed. And file name seem to be suspicious and its a base64 string. So lets decode it.</p><p>After decoding it we got the flag: <strong>flag{!!<em>w3LL_d0n3_St4g3-1_0f_L4B_5_D0n3</em>!!}</strong></p><h2 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag 2"></a>Flag 2</h2><p>So let’s use the flag that we got as the password for the rar archive.</p><p><img src="/images/Memlabs-Lab-5/unrar2.png" alt="Unrar using stage 1 password"></p><p>Hoorah! We got it extracted.</p><p><img src="/images/Memlabs-Lab-5/Stage2.png" alt="Flag"></p><p>That’s how you finish this <strong>MemLabs, Lab – 5</strong>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are provided with a &lt;strong&gt;Windows 7&lt;/strong&gt; memory dump. Let us begin our initial level of analysis.&lt;/p&gt;
&lt;p&gt;Let’s start with the ru
      
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 4 writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-4-writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-4-writeup/</id>
    <published>2020-06-01T06:34:12.000Z</published>
    <updated>2020-07-18T05:12:33.629Z</updated>
    
    <content type="html"><![CDATA[<p>We are provided with a <strong>Windows 7</strong> memory dump. Let’s begin our initial analysis.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab4.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre><p><img src="/images/Memlabs-Lab-4/pslist1.png" alt="pslist"><br><img src="/images/Memlabs-Lab-4/pslist2.png" alt="pslist"></p><p>There is nothing quite interesting in the <strong>pslist</strong> output except for the <strong>Sticky Note</strong> process. Hmm, perhaps there is something written in it.</p><p>Just to keep it short, there was nothing important written in the clipboard. It was a small rabbit hole.</p><p>Now let us proceed to the files present in the system.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab4.raw --profile<span class="token operator">=</span>Win7SP1x64 filescan <span class="token operator">|</span> <span class="token function">grep</span> Desktop</code></pre><p><img src="/images/Memlabs-Lab-4/filescan1.png" alt="filescan"><br><img src="/images/Memlabs-Lab-4/filescan2.png" alt="filescan"></p><p>There are interesting files present on the desktop. The files <code>Important.txt</code>, <code>galf.jpeg</code> &amp; <code>Screenshot1.png</code> are of special interest. Let us try to dump them :)</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab4.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000003e8ad250 -D dump</code></pre><p>Now we have dumped the file <strong>galf.jpeg</strong>. However, doing basic steg techniques on the file yield nothing. So it is useless.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab4.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000003e8d19e0 -D dump</code></pre><p>Now we have dumped the file <strong>Screenshot1.png</strong>. However on doing basic steg techniques on the file yield nothing. so it is useless.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>One important thing in this lab and also the main exploit is to get the data present in the file <strong>Important.txt</strong>. However, dumpfiles will not be able to dump the required file as it has been deleted. However, its contents are still present in memory. If you fundamentally understand the Master File Table(MFT), you would know that we can access the data as long as the data blocks are overwritten.</p><p>For this, we take the help of the <strong>mftparser</strong> plugin.</p><pre><code>$ volatility -f MemoryDump_Lab4.raw --profile=Win7SP1x64 mftparser &gt; mft.txt</code></pre><p>So let us search for the data blocks of the file <strong>Important.txt</strong></p><p><img src="/images/Memlabs-Lab-4/mft.png" alt="mft"></p><p>Aha! Now we see the characters of the flag separated by irregular number of spaces.</p><p>So, combining them we got the flag: <strong>inctf{1_is_n0t_EQu4l_7o_2_bUt_th1s_d0s3nt_m4ke_s3ns3}</strong>.</p><p>That’s how you finish this <strong>MemLabs, Lab – 4</strong>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are provided with a &lt;strong&gt;Windows 7&lt;/strong&gt; memory dump. Let’s begin our initial analysis.&lt;/p&gt;
&lt;h2 id=&quot;Initial-Analysis&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 3 writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-3-writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-3-writeup/</id>
    <published>2020-06-01T06:33:12.000Z</published>
    <updated>2020-07-18T05:12:22.685Z</updated>
    
    <content type="html"><![CDATA[<p>We are provided with a <strong>Windows 7</strong> memory dump. Let’s begin our initial analysis.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>Let’s check what all processes are running.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab3.raw --profile<span class="token operator">=</span>Win7SP1x86 pslist</code></pre><p><img src="/images/Memlabs-Lab-3/pslist1.png" alt="pslist output"><br><img src="/images/Memlabs-Lab-3/pslist2.png" alt="pslist output"></p><p>As we can see only notepad is active, so let us try using <code>cmdline</code> plugin to check the process command line arguments.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab3.raw --profile<span class="token operator">=</span>Win7SP1x86 cmdline</code></pre><p>Going through the cmdline plugin output. In the bottom we can see that,</p><pre><code>notepad.exe pid:   3736Command line : &quot;C:\Windows\system32\NOTEPAD.EXE&quot; C:\Users\hello\Desktop\evilscript.py************************************************************************notepad.exe pid:   3432Command line : &quot;C:\Windows\system32\NOTEPAD.EXE&quot; C:\Users\hello\Desktop\vip.txt</code></pre><p>using notepad the user <code>hello</code> accessed <code>evilscript.py</code> and <code>vip.txt</code>. Let us check if those files are still there in the memory.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab3.raw --profile<span class="token operator">=</span>Win7SP1x86 filescan <span class="token operator">|</span> <span class="token function">grep</span> Desktop</code></pre><p><img src="/images/Memlabs-Lab-3/filescan.png" alt="filescan output"></p><p>As we can see that, those are still present in the memory so we can dump them. And we can see that there is an another file named <code>suspision1.jpeg</code> is also located on same folder. So let’s dump that too</p><p><img src="/images/Memlabs-Lab-3/dumpfiles.png" alt="dumpfiles"></p><p>So lets’s check what’s there in the python file.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">import</span> string<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token keyword">def</span> <span class="token function">encoder</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> x<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"base64"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    f <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\hello\\Desktop\\vip.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>    arr <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    arr <span class="token operator">=</span> encoder<span class="token punctuation">(</span>xor<span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>As we can see the script is xoring a string with 3 and then encoding it to baste64 and writing it to vip.txt. So by doing the same exact thing in reverse way we can get the original string.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>I have done this in ipython:</p><pre class=" language-python"><code class="language-python">a<span class="token operator">=</span><span class="token string">'am1gd2V4M20wXGs3b2U='</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span>q<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span>    q<span class="token operator">+=</span>chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span></code></pre><p>This gave the output as the first half of the flag: <strong>inctf{0n3_h4lf</strong>.</p><p>As we have got a jpg file,</p><p><img src="/images/Memlabs-Lab-3/suspision1.jpeg" alt="jpg file"></p><p>So lets try steghide with out a password and using the first half of the flag as the password.</p><p><img src="/images/Memlabs-Lab-3/steghide.png" alt="steghide output"></p><p>After using the first half of the flag as the password, we got the result <code>secret text</code>. Opening it got the second part of the flag: <strong>_1s_n0t_3n0ugh}</strong></p><p>Flag: <strong>inctf{0n3_h4lf_1s_n0t_3n0ugh}</strong></p><p>That’s how you finish this <strong>MemLabs, Lab – 3</strong>.</p><blockquote><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are provided with a &lt;strong&gt;Windows 7&lt;/strong&gt; memory dump. Let’s begin our initial analysis.&lt;/p&gt;
&lt;h2 id=&quot;Initial-Analysis&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 2 Writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-2-Writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-2-Writeup/</id>
    <published>2020-06-01T06:32:12.000Z</published>
    <updated>2020-07-29T17:07:42.113Z</updated>
    
    <content type="html"><![CDATA[<p>We are provided with a <strong>Windows 7</strong> memory dump. Let’s begin our initial analysis.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>Let’s check what all processes are running.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre><p><img src="/images/Memlabs-Lab-2/pslist1.png" alt="pslist output"><br><img src="/images/Memlabs-Lab-2/pslist2.png" alt="pslist output"></p><p>As we can see <code>chrome</code>, <code>keepass</code> are active running processes, lets check what’s there in them.</p><h2 id="Flag-1"><a href="#Flag-1" class="headerlink" title="Flag 1"></a>Flag 1</h2><p>Let us check the environmental variables. We can check it using <code>envars</code> plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugin<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 envars</code></pre><p><img src="/images/Memlabs-Lab-2/envars.png" alt="envars output"></p><p>As we can see that there is a base64 string, we can decode it. After decoding it we got the first flag: <strong>flag{w3lc0m3_T0_$T4g3_!_Of_L4B_2}</strong></p><h2 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag 2"></a>Flag 2</h2><p>As Keepass is running, let us see whats there in it.</p><p>Keepass is used to store the passwords in a kdbx password database. So lets find the <strong>kdbx</strong> file.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugin<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 filescan <span class="token operator">|</span> <span class="token function">grep</span> kdbx</code></pre><p><img src="/images/Memlabs-Lab-2/kdbx_filescan.png" alt="filescan output"></p><p>We found the kdbx file, so we can dump it.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugin<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000003fb112a0 -D <span class="token keyword">.</span></code></pre><p><img src="/images/Memlabs-Lab-2/kdbx_dumpfiles.png" alt="dump kdbx"></p><p>As Keepass is used for storing password and it should not be revealed easy so it will be protected with a Master password. So in this case also we are asked for Master password. So I thought of searching for all files if there is anything we can find something related to password.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugin<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000003fce1c70 -D <span class="token keyword">.</span></code></pre><p><img src="/images/Memlabs-Lab-2/pass_dumpfiles.png" alt="dump password"></p><p>As we can see the password in the bottom, after using it and opening the Keepass file, I didn’t find anything useful. By checking the <strong>Recycle Bin</strong> one can see the <strong>username: Flag</strong>. So after checking the record, we can find the flag stored as password.</p><p><img src="/images/Memlabs-Lab-2/kdbx_password.png" alt="Password"></p><p>Flag: <strong>flag{w0w_th1s_1s_Th3_SeC0nD_ST4g3_!!}</strong></p><h2 id="Flag-3"><a href="#Flag-3" class="headerlink" title="Flag 3"></a>Flag 3</h2><p>As chrome is running, let’s see the history of chrome.</p><pre class=" language-bash"><code class="language-bash">$ volatility --plugin<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f MemoryDump_Lab2.raw --profile<span class="token operator">=</span>Win7SP1x64 chromehistory</code></pre><p><img src="/images/Memlabs-Lab-2/chromehistory.png" alt="chrome history"></p><p>As we can see that there is a <a href="https://mega.nz/folder/TrgSQQTS#H0ZrUzF0B-ZKNM3y9E76lg">mega link</a>. After opening the mega link, we got zip file.<br>However, the archive is password protected. Also, brute-forcing for the password is not at all intended. So let us use <code>unzip</code> and check what we get.</p><p><img src="/images/Memlabs-Lab-2/unzip.png" alt="unzip output"></p><p>We can see a comment, “<strong>Password is SHA1(stage-3-FLAG) from Lab-1. Password is in lowercase</strong>“.<br>As we have solved Stage 3 of Lab - 1. After using it, we got the the 3rd flag.</p><p><img src="/images/Memlabs-Lab-2/Important.png" alt="Flag 3"></p><p>That’s how you finish this <strong>MemLabs, Lab – 2</strong>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;We are provided with a &lt;strong&gt;Windows 7&lt;/strong&gt; memory dump. Let’s begin our initial analysis.&lt;/p&gt;
&lt;h2 id=&quot;Initial-Analysis&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Memlabs Lab - 1 writeup</title>
    <link href="https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-1-writeup/"/>
    <id>https://bolisettynihith.github.io/Memlabs/Memlabs-Lab-1-writeup/</id>
    <published>2020-06-01T06:31:12.000Z</published>
    <updated>2020-07-18T05:12:28.537Z</updated>
    
    <content type="html"><![CDATA[<p>MemLabs is an educational, introductory set of CTF-styled challenges which is aimed to encourage students, security researchers and also CTF players to get started with the field of Memory Forensics.</p><a id="more"></a><p>The labs given by <a href="https://twitter.com/_abhiramkumar/">@_abhiramkumar</a> are really useful for the beginners to start with Memory Forensics.</p><p>The memory files and Descriptions are available in his <a href="https://github.com/stuxnet999/MemLabs">github repo</a>.<br>If you are having any troubles in the commands used, you can refer <a href="https://github.com/volatilityfoundation/volatility/wiki/Command-Reference">volatility command referance</a>.</p><h2 id="Lab-1-Writeup"><a href="#Lab-1-Writeup" class="headerlink" title="Lab - 1 Writeup"></a>Lab - 1 Writeup</h2><p>We are provided with the windows 7 memory dump. To know which OS’s memory dump we have, we can use imageinfo plugin to find the profile. Let’s begin with the initial level of analysis.</p><pre class=" language-bash"><code class="language-bash">$ Volatility -f MemoryDump_Lab1.raw imageinfo</code></pre><p><img src="/images/Memlabs-Lab-1/imageinfo.png" alt="imageinfo output"></p><p>As we got the profile, we can use it and get the processes running in at the time for memory capture.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre><p><img src="/images/Memlabs-Lab-1/pslist_1.png" alt="pslist output"><br><img src="/images/Memlabs-Lab-1/pslist_2.png" alt="pslist output"></p><p>As we see above cmd, mspaint and WinRAR are the active running processes.</p><h3 id="Flag-1"><a href="#Flag-1" class="headerlink" title="Flag - 1"></a>Flag - 1</h3><p>So let us see what is there in cmd.exe.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 consoles</code></pre><p><img src="/images/Memlabs-Lab-1/consoles.png" alt="consoles output"><br>You can see a base64 string. After decoding base64, we got the first flag: <strong>flag{th1s_1s_th3_1st_st4g3!!}</strong></p><h3 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag - 2"></a>Flag - 2</h3><p>As mspaint is also an active running process, Let us check it out.<br>To find what is running in mspaint, first we need to take dump the mspaint.exe (PID 2424) as shown below.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 memdump -p 2424 -D dump</code></pre><p><img src="/images/Memlabs-Lab-1/memdump_mspaint.png" alt="Memdump MSPaint"><br>Next, we need to change the extension of <strong>2424.dmp</strong> to <strong>2424.data</strong>. And we need to open 2424.data using <strong>GIMP(GNU Image Manipulation Program)</strong>.<br>After opening the image using GIMP, this is what we got,</p><p><img src="/images/Memlabs-Lab-1/load_gimp.png" alt="load in gimp"></p><p>After changing the values of width and height using up and down arrows, We will somehing similar to this.</p><p><img src="/images/Memlabs-Lab-1/gimp_flag.png" alt="mogify height and width"></p><p>After modifying the image to understandable side, we will get something similar to this,</p><p><img src="/images/Memlabs-Lab-1/gimp_flag_1.png" alt="flag - 2"></p><p>Here you get the second flag.<br>Flag: <strong>flag{G00d_BoY_good_girL}</strong></p><h3 id="Flag-3"><a href="#Flag-3" class="headerlink" title="Flag - 3"></a>Flag - 3</h3><p>As WinRAR is also running that means some sort of archive has been opened. So let us check for an archive in the given memory dump.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 filescan <span class="token operator">|</span> <span class="token function">grep</span> Documents</code></pre><p><img src="/images/Memlabs-Lab-1/rar_filescan.png" alt="Documents filescan output"></p><p>Here, we can see a file Important.rar in Documents Folder. So we will dump it and check it.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 dumpfiles -Q 0x000000003fa3ebc0 -D dump</code></pre><p><img src="/images/Memlabs-Lab-1/rar_dumpfiles.png" alt="Dumpfiles Important.rar"></p><p>However, the archive is password protected. Also, brute-forcing for the password is not at all intended. So let us use unrar command and check what we get.</p><p><img src="/images/Memlabs-Lab-1/unrar.png" alt="unrar output"></p><p>It’s written that, “<strong>Password is NTLM hash(in uppercase) of Alissa’s account passwd</strong>”.<br>We can get Alissa’s account NTLM hash from hashdump.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f MemoryDump_Lab1.raw --profile<span class="token operator">=</span>Win7SP1x64 hashdump</code></pre><p><img src="/images/Memlabs-Lab-1/hashdump.png" alt="hashdump output"></p><p>So using the Alissa Simpson’s hash (<strong>f4ff64c8baac57d22f22edc681055ba6</strong>) in upper case and entering it as the password for RAR, we get the flag.</p><p>So finally we get the third flag.</p><p><img src="/images/Memlabs-Lab-1/flag3.png" alt="flag - 3"></p><p>That’s how you finish this <strong>MemLabs, Lab – 1</strong>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MemLabs is an educational, introductory set of CTF-styled challenges which is aimed to encourage students, security researchers and also CTF players to get started with the field of Memory Forensics.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/categories/Memlabs/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memlabs" scheme="https://bolisettynihith.github.io/tags/Memlabs/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Securinets-CTF’20–Time-Matters</title>
    <link href="https://bolisettynihith.github.io/Securinets-CTF%E2%80%9920%E2%80%93Time-Matters/"/>
    <id>https://bolisettynihith.github.io/Securinets-CTF%E2%80%9920%E2%80%93Time-Matters/</id>
    <published>2020-05-26T08:18:38.000Z</published>
    <updated>2020-07-17T15:55:32.896Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>chrome history analysis</li><li>File recovery from memory dump</li><li>Simple stego</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/TimeMatters/description.png" alt="Description"></p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are given with a Windows 7 memory dump. Let’s see what all processes are running in the macine.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 pslist</code></pre><p><img src="/images/TimeMatters/pslist.png" alt="PSList"></p><p>We can see Explorer and chrome are in open, lets check what’s there in Chrome’s history. We know that for their is a plugin <strong>chromehistory</strong>, we will use that.</p><pre class=" language-bash"><code class="language-bash">volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 chromehistory</code></pre><p><img src="/images/TimeMatters/chromehistory.png" alt="chrome history"></p><p>We didn’t find any suspicious links in chrome’s history. </p><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>So let’s check what all files are there in the system.</p><pre class=" language-bash"><code class="language-bash">volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 filescan <span class="token operator">|</span> <span class="token function">grep</span> Desktop</code></pre><p><img src="/images/TimeMatters/filescan_desktop.png" alt="Filescan Desktop"></p><p>We can steghide and a jpg image on the desktop, So let’s dumpfile the jpg file and use steghide on it.</p><p><img src="/images/TimeMatters/dumpfiles.png" alt="dumpfiles"></p><p>When I used steghide for extaction, it asked for the password, I followed the same way as everyone does, just leaving it <strong>blink</strong> and clicking <strong>Enter</strong>. But no use.</p><p><img src="/images/TimeMatters/steghide_wop.png" alt="Steghide Without PSSWD"></p><p>So I thought to use the users password and got the NTLM hash using hashdump, but when cracked hash didn’t gave the result.</p><p><img src="/images/TimeMatters/hashdump.png" alt="hashdump"> <img src="/images/TimeMatters/crackstation.png" alt="crackstation"></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>So after opening the image, it’s Messi’s image which was took on 2019. So the on looking at the challenge titile and relating that to the password of steghide, we can use <strong>Messi2019</strong> as password and try what we can get.</p><p><img src="/images/TimeMatters/DS0394.jpg" alt="Messi Image"><br><img src="/images/TimeMatters/steghide_2.png" alt="Using Messi2019 as Password"></p><p>Hoorah!! We got the output. One opening the resulted image, we got the flag.</p><p><img src="/images/TimeMatters/image.png" alt="Flag"></p><p>There is an other way also, by using <strong>mimikatz</strong> for getting the user password. But when I used the password that we got in <strong>mimikatz</strong>, I didn’t got anything, so after modifing the password by relating to the challenge title and modifying it to <strong>Messi2020</strong>, we can get the flag.</p><p><img src="/images/TimeMatters/mimikatz.png" alt="mimikatz"><br><img src="/images/TimeMatters/steghide_1.png" alt="using Messi2020 as password"></p><p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;chrome history analysis&lt;/li&gt;
&lt;li&gt;File recovery from memory dump&lt;/li&gt;
&lt;li&gt;Simple stego&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Memory Forensics" scheme="https://bolisettynihith.github.io/categories/Writeups/Memory-Forensics/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>HackTM Quals 20 – Find my Pass Writeup</title>
    <link href="https://bolisettynihith.github.io/HackTM-Quals-20%E2%80%93Find-my-Pass-Writeup/"/>
    <id>https://bolisettynihith.github.io/HackTM-Quals-20%E2%80%93Find-my-Pass-Writeup/</id>
    <published>2020-04-11T12:22:40.000Z</published>
    <updated>2020-07-17T15:58:15.515Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Memory dump analysis using Volatility.</li><li>Extracting Keepass Master Password from the memory.</li><li>Extracting flag from ZIP archive attached in the Keepass database.</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>I managed to forget my password for my KeePass Database but luckily I had it still open and managed to get a dump of the system’s memory. Can you please help me recover my password?</p><p>Challenge file: <a href="https://mega.nz/#!IdUVwY6I!uJWGZ932xab44H4EJ-zVAqu6_UWNJcCVA4_PPXdqCyc">Mega Drive</a> or <a href="https://drive.google.com/open?id=1hUlGqJZYgbWaEu7w0JnPMqgYdFr8qVJe">Google Drive</a></p><p>Password: <strong>eD99mLkU</strong></p><p>Hint: I am not very good with computers, I use my one safe password where I want to keep everything safe from hackers.</p><p>I solved this challenge after the CTF has ended.</p><p>According to the description, In this challenge, we have to retrieve the Master Password of a Keepass database from the memory.</p><h2 id="Initial-Anaysis"><a href="#Initial-Anaysis" class="headerlink" title="Initial Anaysis"></a>Initial Anaysis</h2><p>First, you need to find what OS his system was using. For that, I used imageinfo plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem imageinfo</code></pre><p><img src="/images/Find-my-Pass/imageinfo.png" alt="Imageinfo Output"></p><p>I choose <strong>Win7SP1x86</strong> profile.<br>Let’s check what all processes are running in the system. We can expect that keepass.exe will be present, as the description says that the database was kept open.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 pslist</code></pre><p><img src="/images/Find-my-Pass/pslist_1.png" alt="pslist output"><br><img src="/images/Find-my-Pass/pslist_2.png" alt="pslist output"></p><p>We can see that the keepass.exe process was running and going further.</p><h2 id="Extracting-Keepass-database"><a href="#Extracting-Keepass-database" class="headerlink" title="Extracting Keepass database"></a>Extracting Keepass database</h2><p>We need to find the .kdbx file as all KeePass databases are stored with extension .kdbx. For that, we will use filescan plugin and grep for kdbx files.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 filescan <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">".kdbx"</span></code></pre><p><img src="/images/Find-my-Pass/kdbx_filescan.png" alt="Filescan Kdbx"></p><p>We can see a database.kdbx was open and the further step is to dump that file to our host system. For that, we will use dumpfiles plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 dumpfiles -Q 0x000000007df37c88 -D <span class="token keyword">.</span></code></pre><p><img src="/images/Find-my-Pass/kdbx_dumpfiles.png" alt="Dumpfiles kdbx"></p><p>When I attempted to open the database, it asked for the master password. The description says that the user has forgotten his password which means we have to recover it.</p><h2 id="Retriving-Master-Password"><a href="#Retriving-Master-Password" class="headerlink" title="Retriving Master Password"></a>Retriving Master Password</h2><p>But the hint says user used the same password everywhere ie: he must have copied the password and user it somewhere else. So let’s check what’s there in his clipboard. For that, we use the clipboard plugin.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 clipboard</code></pre><p><img src="/images/Find-my-Pass/clipboard.png" alt="Clipboard"></p><p>We can’t find anything in the clipboard. It seems to be suspicious. So let’s check the verbose data of the clipboard.</p><pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 clipboard -v</code></pre><p><img src="/images/Find-my-Pass/clipboard-v.png" alt="clipboard -v"></p><p>Hurrah! We found it.</p><p>By removing the dots and using it (<strong>dmVZQmdzOlUrcEBlRj87dHQ3USVBIn</strong>) as the master password we got into the Keepass database.</p><p>In the bottom, in attachments, we can see that there is <strong>nothinghere.7z</strong> file that was attached to the password entry.</p><p>We can extract that from the <strong>File Attachments</strong> in the <strong>Advanced tab</strong> of <strong>Edit Entry</strong>.</p><p>The 7z file asked for a password and on using the database master password we successfully extracted the text file. It contained the flag.</p><p>Flag: <strong>HackTM{d14c02244b17f4f9dfc0f71ce7ab10e276a5880a05fca64d39a716bab92cda90}</strong></p><p>The another way of solving this challenge is mentioned in <a href="https://blog.bi0s.in/2020/02/09/Forensics/HackTM-FindMyPass/">blog.bi0s.in</a> by my mentor <a href="https://twitter.com/_abhiramkumar">@_abhiramkumar</a>.</p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Memory dump analysis using Volatility.&lt;/li&gt;
&lt;li&gt;Extracting Keepass Master Password from the memory.&lt;/li&gt;
&lt;li&gt;Extracting flag from ZIP archive attached in the Keepass database.&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Memory Forensics" scheme="https://bolisettynihith.github.io/categories/Writeups/Memory-Forensics/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Fresh From The Oven - InCTF Internationals 2019 Writeup</title>
    <link href="https://bolisettynihith.github.io/InCTFi19-Fresh-From-the-Oven/"/>
    <id>https://bolisettynihith.github.io/InCTFi19-Fresh-From-the-Oven/</id>
    <published>2019-10-03T11:22:56.000Z</published>
    <updated>2020-07-18T04:59:01.350Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Decoding the strings found in TCP stream 0.</li><li>Analysing and extracting data sent via different ports of TCP.</li><li>Using character-wise caesar from the extracted data.</li><li>Zip cracking</li></ul><a id="more"></a><h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/FreshFromtheOven/description.png" alt="Description"></p><p>You can download the challenge file from <a href="https://mega.nz/#!d6wEFICJ!u9XykRdIoJtloYDZQxFqXt1KvWR5aK3Ucisd2-a-qms"><strong>Mega</strong></a> or <a href="https://drive.google.com/file/d/1ZBLNYqFOA0dOx8e1GnNoO3qn2V0Elpcm/view?usp=sharing"><strong>G-Drive</strong></a></p><p>This is a challenge which I made for InCTFi’19 along with my teammate(<a href="https://twitter.com/__Sh4d0w__">@Sh4d0w</a>).</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with a <strong>pcap</strong> file. Let’s start our initial analysis.</p><p>We can see so many TCP packets in the capture file and the description says that it was a chat between two friends. So let’s follow the TCP stream and see if anything is interesting in it.</p><p><img src="/images/FreshFromtheOven/tcp-stream-0.png" alt="TCP Stream"></p><p>We do see a chat between 2 people. Also, we can find some encoded strings. The secret code: <strong>Remember remember the FIFTH of november :)</strong> does hint out something. We can assume the encoded strings are <strong>ROT5</strong>. Decoding them, we get;</p><pre><code>Rohith: This is a sample in that encoded way.Shyam: Oh, It&#39;s good and it took a lot of time to understand for me.Rohith: Sending you some interesting files, try to find the secret behind them and keep it confidentialShyam: Okay, sure:)</code></pre><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As the chat between them says that some files have transferred. And we can see that from <strong>TCP Stream 2</strong>, extra data with <strong>800 bytes</strong> is transferred in two different destination ports(<strong>444</strong> &amp; <strong>81</strong>). We can assume that the two files have been transferred.</p><p>Extracting the data sent to the above-mentioned ports and applying <strong>Caesar cipher</strong> on the two files, we get the file structure of a <strong>PDF file</strong> and a <strong>ZIP file</strong>.</p><p><img src="/images/FreshFromtheOven/file_pdf.png" alt="File PDF"></p><p><img src="/images/FreshFromtheOven/file_zip.png" alt="File zip"></p><p>After opening the PDF and we find extra spaces in the last page of that file. It says “<strong>NOTHING HERE :( DON’T WASTE YOUR TIME</strong>“.</p><p>So it’s just a <strong>rabbit hole</strong>.</p><p>After a brief observation, we see that the ZIP is password protected. So, we use <strong>fcrackzip</strong> in dictionary mode to crack the password,</p><p><img src="/images/FreshFromtheOven/zip_cracking.png" alt="zip cracking"></p><p>The password is <strong>johnjandroveclarkmichaelkent</strong>.</p><p>Extracting the file from the zip gave a <strong>PNG</strong> image.</p><p><img src="/images/FreshFromtheOven/flag.png" alt="flag"></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Simple LSB steg can be used to get the flag. We used the popular tool <strong>zsteg</strong> for this.</p><p>FLAG: <strong>inctf{3ach_4nd_3v3ry_s3cre7_inf0rm4t10n_w1ll_b3_kn0wn_by_wir3shark!!!!!_:)}</strong></p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Decoding the strings found in TCP stream 0.&lt;/li&gt;
&lt;li&gt;Analysing and extracting data sent via different ports of TCP.&lt;/li&gt;
&lt;li&gt;Using character-wise caesar from the extracted data.&lt;/li&gt;
&lt;li&gt;Zip cracking&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Network" scheme="https://bolisettynihith.github.io/categories/Writeups/Network/"/>
    
    
      <category term="Steganography" scheme="https://bolisettynihith.github.io/tags/Steganography/"/>
    
      <category term="Wireshark" scheme="https://bolisettynihith.github.io/tags/Wireshark/"/>
    
  </entry>
  
  <entry>
    <title>Hackcon CTF’19 – GIMP IT Writeup</title>
    <link href="https://bolisettynihith.github.io/Hackcon-CTF%E2%80%9919-%E2%80%93-GIMP-IT-Writeup/"/>
    <id>https://bolisettynihith.github.io/Hackcon-CTF%E2%80%9919-%E2%80%93-GIMP-IT-Writeup/</id>
    <published>2019-08-24T12:43:39.000Z</published>
    <updated>2020-07-17T16:38:08.780Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Analysing layers for an image</li><li>PIL</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/gimpit/description.png" alt="description"></p><p>As the challenge name suggests, use GIMP we will proceed with it. After opening the image in GIMP, we can see another layer in the image. So on choosing/making that layer visible we can see the content in that layer.</p><p><img src="/images/gimpit/layer_2_gimp.png" alt="layer 2"></p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We can see the “Nothing here” layer present in the image but we cannot understand the contents in it. These type of files also gives an additional advantage that the contents present in them are visible in original file data in form hex or in normal text. So after using strings we can see that there is a hex data present in it.</p><p><img src="/images/gimpit/strings_output.png" alt="strings output"></p><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>The hex data is a zip file, so copying that data and making a file out it, we got an another file present in it. And that file contains of only 1’s and 0’s. First thought that it would an esolang(spoon) but didn’t anything. So there are somany 1’s and 0’s we thought of making an image from it. But we need the size of the image. And the len(whole binary string) is exactly the square of 370, we will use it as the image height &amp; width. Assuming 0 = (255, 255, 255) and 1 = (0, 0, 0).</p><p>So performed the operation in ipython and got an QR code. Here is the code;</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Imagef<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>t<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        t<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        t<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>im <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">370</span><span class="token punctuation">,</span><span class="token number">370</span><span class="token punctuation">)</span><span class="token punctuation">)</span>im<span class="token punctuation">.</span>putdata<span class="token punctuation">(</span>t<span class="token punctuation">)</span>im<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span></code></pre><p>On running the above code in python got a QR code and after scanning it got the flag.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Flag: <strong>d4rk{L0t5_0f_th1ng5_t0_d0_1n_th15_chAll@ng3}c0de</strong></p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Analysing layers for an image&lt;/li&gt;
&lt;li&gt;PIL&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Steganography" scheme="https://bolisettynihith.github.io/categories/Writeups/Steganography/"/>
    
    
      <category term="Steganography" scheme="https://bolisettynihith.github.io/tags/Steganography/"/>
    
      <category term="Python" scheme="https://bolisettynihith.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Hackcon CTF’19 – Too cold for steg Writeup</title>
    <link href="https://bolisettynihith.github.io/Hackcon-CTF%E2%80%9919-%E2%80%93-Too-cold-for-steg-Writeup/"/>
    <id>https://bolisettynihith.github.io/Hackcon-CTF%E2%80%9919-%E2%80%93-Too-cold-for-steg-Writeup/</id>
    <published>2019-08-24T12:14:36.000Z</published>
    <updated>2020-07-17T16:35:23.093Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Whitespace steganography</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/Toocoldforsteg/description.png" alt="Description"></p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>Got a text file and opening the text file in any text editor and selecting all the text we can find some whitespace present at the ending of the each each line.</p><p>As the title is Too cold to steg we will get a tool known as stegsnow in our mind.</p><p>But for using the stegsnow we need a password. After searching for the password in the file given we can get the password as <strong>d4rkc0de-IIITD</strong>.</p><p><img src="/images/Toocoldforsteg/grep_password.png" alt="grep password"></p><p>Then using the stegsnow we will get the flag.</p><p><img src="/images/Toocoldforsteg/stegsnow.png" alt="stegsnow command"></p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Flag: <strong>d4rk{h@ving_fun_w1th_st3gsn0w?}c0de</strong></p><p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Whitespace steganography&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Steganography" scheme="https://bolisettynihith.github.io/categories/Writeups/Steganography/"/>
    
    
      <category term="whitespace" scheme="https://bolisettynihith.github.io/tags/whitespace/"/>
    
  </entry>
  
  <entry>
    <title>Securinets CTF’19 – Rare to win Writeup</title>
    <link href="https://bolisettynihith.github.io/Securinets-CTF%E2%80%9919-%E2%80%93-Rare-to-win-Challenge/"/>
    <id>https://bolisettynihith.github.io/Securinets-CTF%E2%80%9919-%E2%80%93-Rare-to-win-Challenge/</id>
    <published>2019-08-17T05:14:08.000Z</published>
    <updated>2020-07-18T03:36:42.692Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Chrome history analysis</li><li>ACE file analysis</li><li>Detecting the virus</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/Raretowin/description.png" alt="Description"></p><p>I could not solve this challenge at the time of the CTF. But it is a nice challenge.</p><p>Given with an Windows 7 memory dump, lets see what all processes are running in the machine/system.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>As the description of the says that the operator was browsing web the he might be using one of the browsers like Chrome, Firefox, or inbuilt Explorer. So lets go and see the pslist.</p><p><img src="/images/Raretowin/pslist.png" alt="PSlist output"></p><p>As we can see that chrome was running in system at the time when the dump was captured. So as the Chrome was running in the system we can use chrome history plugin and get the users history data.</p><p><img src="/images/Raretowin/chromehistory.png" alt="Chrome History"></p><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As we can see that, there is file called <strong>music.rar</strong> was downloaded from the chrome. So we will search for the file in the dump, using filescan plugin.</p><p><img src="/images/Raretowin/filescan_music_rar.png" alt="filescan_music_rar"></p><p>It resulted that there is no file relating to it. So I have downloaded the file from the <a href="https://www.mediafire.com/file/2t7bb2mflg2lwwj/music.rar/file">link</a> he browsed.</p><p>I tried opening the rar but it does not shown any files and it was in <strong>Read Only</strong> mode. So tried running <strong>file command</strong> on it and got to know that it is an <strong>ACE</strong> file.</p><p><img src="/images/Raretowin/file_music.png" alt="file command"></p><p>After a quick search in google, i came to know that there are some tools to open and extract the file from the ace file. So I renamed it and tried the unace command line tool which was provided by the Ubuntu software. But it doesn’t gave any results. So I checked for other alternatives and found <a href="http://webdiis.unizar.es/pub/unix/archive/linunace25.tgz">this</a>.</p><p>After using that tool, I can see that there is a firefox.exe and it is unable to override the build in firefox of the host system as I didn’t run with sudo permission.</p><p><img src="/images/Raretowin/unace.png" alt="unace"></p><p>And also if we use binwalk on the that ace file, we can see an <strong>ELF</strong> file present in it. And loading that in gdb and seeing the main function of the elf, there is only one operation going on that is the <strong>printf function</strong>. So we can say that the exe was the <strong>virus</strong> that the challenge author has asked.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>But the flag is the <strong>path_to_the_virus</strong>. So as we can see that the exe file was extracting to <strong>C:/Users/Public/Data/firefox.exe</strong> therefore that will be the path that they have asked.</p><p>But in windows the folders are divided using “\\” so the resulting path is <strong>C:\\Users\\Public\\Data\\firefox.exe</strong>.</p><p>And the flag will be,</p><p>Flag : <strong>securinets{84117b4eb400242a9db464e84220e672}</strong></p><p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Chrome history analysis&lt;/li&gt;
&lt;li&gt;ACE file analysis&lt;/li&gt;
&lt;li&gt;Detecting the virus&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Memory Forensics" scheme="https://bolisettynihith.github.io/categories/Writeups/Memory-Forensics/"/>
    
    
      <category term="Volatility" scheme="https://bolisettynihith.github.io/tags/Volatility/"/>
    
      <category term="Memory" scheme="https://bolisettynihith.github.io/tags/Memory/"/>
    
  </entry>
  
  <entry>
    <title>Swamp CTF’18 – Orcish Writeup</title>
    <link href="https://bolisettynihith.github.io/Swamp-CTF%E2%80%9918-%E2%80%93-Orcish-challenge/"/>
    <id>https://bolisettynihith.github.io/Swamp-CTF%E2%80%9918-%E2%80%93-Orcish-challenge/</id>
    <published>2019-08-11T06:25:03.000Z</published>
    <updated>2020-07-17T16:22:05.220Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>Analysing ICMP type field and extracting GIF file</li></ul><a id="more"></a><h2 id="Descritpion"><a href="#Descritpion" class="headerlink" title="Descritpion"></a>Descritpion</h2><p><img src="/images/orcish/description.png" alt="Description"></p><p>This is a good challenge and very useful challenge for learning about Networking and it’s related concepts.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>In this challenge on opening the pcap file and checking the protocol hierarchy, we can see so many protocols are present in it.</p><p><img src="/images/orcish/protocol_hiercy.png" alt="Protocol Hierarchy"></p><p>As usually, as there are so many HTTP and TCP packets in that, so using the Export objects we can extract the HTTP data from the packets. But could not find anything interesting from that. As we know that the same HTTP data is transferred via TCP also no need of extracting the TCP data from the TCP packets. I have wasted a lot of time in analysing those data and those packets.</p><p>After going into ICMP packets, we can see the <strong>GIF file signature(GIF89a)</strong>, splitted through upcoming packets. So we can assume that a <strong>GIF file</strong> is transferred in ICMP packets.</p><p><img src="/images/orcish/gif_1.png" alt="first byte"> <img src="/images/orcish/gif_2.png" alt="second byte"> <img src="/images/orcish/gif_3.png" alt="third byte"> <img src="/images/orcish/gif_4.png" alt="forth byte"> <img src="/images/orcish/gif_5.png" alt="fifth byte"> <img src="/images/orcish/gif_6.png" alt="sixth byte"></p><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>So, we know that scapy a powerful packet manipulation program. Extracting the specified packets(ICMP) and reading the packet through scapy, we can see that, type layer of the ICMP packets was transferring the data.</p><p><img src="/images/orcish/display_scapy.png" alt="Load Scapy"></p><p>So, I have written an exploit script, to get the whole required data <strong>(ICMP type)</strong> from the ICMP packets. You need to export all the ICMP packets and save it as <strong>exported.pcap</strong>, and run the script below.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span>all <span class="token keyword">import</span> <span class="token operator">*</span>f<span class="token operator">=</span>rdpcap<span class="token punctuation">(</span><span class="token string">'exported.pcap'</span><span class="token punctuation">)</span>x<span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token operator">+=</span>chr<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span>b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'flag.gif'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>x<span class="token punctuation">)</span>b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>After running the above code it will create a new file named <strong>flag.gif</strong> and after opening it we got the flag.</p><p><img src="/images/orcish/flag.gif" alt="Flag"></p><p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Analysing ICMP type field and extracting GIF file&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Network" scheme="https://bolisettynihith.github.io/categories/Writeups/Network/"/>
    
    
      <category term="Python" scheme="https://bolisettynihith.github.io/tags/Python/"/>
    
      <category term="Wireshark" scheme="https://bolisettynihith.github.io/tags/Wireshark/"/>
    
      <category term="Network" scheme="https://bolisettynihith.github.io/tags/Network/"/>
    
  </entry>
  
  <entry>
    <title>Swamp CTF’19 - The Cyber War Continues Writeup</title>
    <link href="https://bolisettynihith.github.io/Swamp-CTF%E2%80%9919-The-Cyber-War-Continues/"/>
    <id>https://bolisettynihith.github.io/Swamp-CTF%E2%80%9919-The-Cyber-War-Continues/</id>
    <published>2019-04-09T07:15:17.000Z</published>
    <updated>2020-07-17T16:20:47.001Z</updated>
    
    <content type="html"><![CDATA[<p><strong>tl;dr</strong></p><ul><li>USB leftover Capture data extraction.</li></ul><a id="more"></a><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote><p>As you and your convoy circle the barren lands on your light cycles you notice something strange in the distance. Upon further investigation you find what seems to be the remnants of a battle.</p><p>Bodies, robotic and organic alike, are strewn all over the place. You begin scavenging for supplies and weapons, suddenly a man near death thrusts his hand and grabs your arm. “Please” he croaks, “find my friends”.</p><p>He hands you a USB as he takes his last breath. You plug the drive into your mechanical arm and the contents start flooding your HUD. It contains this message and an encrypted file.</p></blockquote><p>Click <a href="https://drive.google.com/drive/u/0/folders/1dTzkvMUmiqKmtkBgyFevXob9WOXsCZQA">here</a>, to download challenge file.</p><h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>In this challenge we got a 7z file which was password protected and a text file. I don’t know why they have given that text file, as of now my aim was to crack the password for the ‘7z file’.</p><p><img src="/images/cyberwar/7z.png" alt="Protected 7z"></p><p>So, I used an <a href="https://www.lostmypass.com/file-types/7z/">online tool</a> to crack the 7z password. And it gave me the password as “toor”, using this as the password for the archive and extracting it, got a pcap.</p><p><img src="/images/cyberwar/pcap.png" alt="Display pcap"></p><p>On analysing that pcap file, all the packets present in that pcap file are related to USB Protocol and on observing the left over capture data got to know that it was based on the keyboard Strokes.</p><h2 id="Futher-Analysis"><a href="#Futher-Analysis" class="headerlink" title="Futher Analysis"></a>Futher Analysis</h2><p>So, on googling found a <a href="https://bitvijays.github.io/LFC-Forensics.html">script</a> for USB Keyboard Strokes and i have rewritten that code such that it will automate all the process we do manually and will give the flag out. The code follows,</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> osusb_codes <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token number">0x04</span><span class="token punctuation">:</span><span class="token string">"aA"</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">:</span><span class="token string">"bB"</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">:</span><span class="token string">"cC"</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">:</span><span class="token string">"dD"</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">:</span><span class="token string">"eE"</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">:</span><span class="token string">"fF"</span><span class="token punctuation">,</span>   <span class="token number">0x0A</span><span class="token punctuation">:</span><span class="token string">"gG"</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">:</span><span class="token string">"hH"</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">:</span><span class="token string">"iI"</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">:</span><span class="token string">"jJ"</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">:</span><span class="token string">"kK"</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">:</span><span class="token string">"lL"</span><span class="token punctuation">,</span>   <span class="token number">0x10</span><span class="token punctuation">:</span><span class="token string">"mM"</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">:</span><span class="token string">"nN"</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">:</span><span class="token string">"oO"</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">:</span><span class="token string">"pP"</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">:</span><span class="token string">"qQ"</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">:</span><span class="token string">"rR"</span><span class="token punctuation">,</span>   <span class="token number">0x16</span><span class="token punctuation">:</span><span class="token string">"sS"</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">:</span><span class="token string">"tT"</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">:</span><span class="token string">"uU"</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">:</span><span class="token string">"vV"</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">:</span><span class="token string">"wW"</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">:</span><span class="token string">"xX"</span><span class="token punctuation">,</span>   <span class="token number">0x1C</span><span class="token punctuation">:</span><span class="token string">"yY"</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">:</span><span class="token string">"zZ"</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">:</span><span class="token string">"1!"</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">:</span><span class="token string">"2@"</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">:</span><span class="token string">"3#"</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">:</span><span class="token string">"4$"</span><span class="token punctuation">,</span>   <span class="token number">0x22</span><span class="token punctuation">:</span><span class="token string">"5%"</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">:</span><span class="token string">"6^"</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">:</span><span class="token string">"7&amp;"</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">:</span><span class="token string">"8*"</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">:</span><span class="token string">"9("</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">:</span><span class="token string">"0)"</span><span class="token punctuation">,</span>   <span class="token number">0x2C</span><span class="token punctuation">:</span><span class="token string">"  "</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">:</span><span class="token string">"-_"</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">:</span><span class="token string">"=+"</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">:</span><span class="token string">"[{"</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">:</span><span class="token string">"]}"</span><span class="token punctuation">,</span>  <span class="token number">0x32</span><span class="token punctuation">:</span><span class="token string">"#~"</span><span class="token punctuation">,</span>   <span class="token number">0x33</span><span class="token punctuation">:</span><span class="token string">";:"</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">:</span><span class="token string">"'\""</span><span class="token punctuation">,</span>  <span class="token number">0x36</span><span class="token punctuation">:</span><span class="token string">",&lt;"</span><span class="token punctuation">,</span>  <span class="token number">0x37</span><span class="token punctuation">:</span><span class="token string">".>"</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span>   <span class="token punctuation">}</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">]</span>pos <span class="token operator">=</span> <span class="token number">0</span>os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'tshark -r location.pcap -T fields -e usb.capdata > d.txt'</span><span class="token punctuation">)</span>f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  d<span class="token operator">=</span>str<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  d<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">]</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"00"</span> <span class="token operator">or</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token operator">and</span> d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>a<span class="token punctuation">)</span>b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'k1'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>a<span class="token punctuation">)</span>b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token keyword">in</span> open<span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   c <span class="token operator">=</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># newline or down arrow - move down</span>   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x51</span> <span class="token operator">or</span> c <span class="token operator">==</span> <span class="token number">0x28</span><span class="token punctuation">:</span>       pos <span class="token operator">+=</span> <span class="token number">1</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># up arrow - move up</span>   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x52</span><span class="token punctuation">:</span>       pos <span class="token operator">-=</span> <span class="token number">1</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># select the character based on the Shift key</span>   <span class="token keyword">if</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   <span class="token keyword">else</span><span class="token punctuation">:</span>       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></code></pre><p>After running the above code for USB keyboard hid keys, got an output as some random string,</p><p><img src="/images/cyberwar/random_string.png" alt="Random String"></p><p>The random string is : <strong>synt{jne_arire_punatrf}</strong></p><p>I understood that random string was a <strong>Caesar Cipher</strong>. So I re-modified the above code such a way that we get the deciphered flag as we can see that the difference between <strong>s</strong> and <strong>f</strong> is <strong>13</strong>, so I remodified like that. Modified code is,</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> osusb_codes <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token number">0x04</span><span class="token punctuation">:</span><span class="token string">"aA"</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">:</span><span class="token string">"bB"</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">:</span><span class="token string">"cC"</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">:</span><span class="token string">"dD"</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">:</span><span class="token string">"eE"</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">:</span><span class="token string">"fF"</span><span class="token punctuation">,</span>   <span class="token number">0x0A</span><span class="token punctuation">:</span><span class="token string">"gG"</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">:</span><span class="token string">"hH"</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">:</span><span class="token string">"iI"</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">:</span><span class="token string">"jJ"</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">:</span><span class="token string">"kK"</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">:</span><span class="token string">"lL"</span><span class="token punctuation">,</span>   <span class="token number">0x10</span><span class="token punctuation">:</span><span class="token string">"mM"</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">:</span><span class="token string">"nN"</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">:</span><span class="token string">"oO"</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">:</span><span class="token string">"pP"</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">:</span><span class="token string">"qQ"</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">:</span><span class="token string">"rR"</span><span class="token punctuation">,</span>   <span class="token number">0x16</span><span class="token punctuation">:</span><span class="token string">"sS"</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">:</span><span class="token string">"tT"</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">:</span><span class="token string">"uU"</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">:</span><span class="token string">"vV"</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">:</span><span class="token string">"wW"</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">:</span><span class="token string">"xX"</span><span class="token punctuation">,</span>   <span class="token number">0x1C</span><span class="token punctuation">:</span><span class="token string">"yY"</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">:</span><span class="token string">"zZ"</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">:</span><span class="token string">"1!"</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">:</span><span class="token string">"2@"</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">:</span><span class="token string">"3#"</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">:</span><span class="token string">"4$"</span><span class="token punctuation">,</span>   <span class="token number">0x22</span><span class="token punctuation">:</span><span class="token string">"5%"</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">:</span><span class="token string">"6^"</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">:</span><span class="token string">"7&amp;"</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">:</span><span class="token string">"8*"</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">:</span><span class="token string">"9("</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">:</span><span class="token string">"0)"</span><span class="token punctuation">,</span>   <span class="token number">0x2C</span><span class="token punctuation">:</span><span class="token string">"  "</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">:</span><span class="token string">"-_"</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">:</span><span class="token string">"=+"</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">:</span><span class="token string">"[{"</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">:</span><span class="token string">"]}"</span><span class="token punctuation">,</span>  <span class="token number">0x32</span><span class="token punctuation">:</span><span class="token string">"#~"</span><span class="token punctuation">,</span>   <span class="token number">0x33</span><span class="token punctuation">:</span><span class="token string">";:"</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">:</span><span class="token string">"'\""</span><span class="token punctuation">,</span>  <span class="token number">0x36</span><span class="token punctuation">:</span><span class="token string">",&lt;"</span><span class="token punctuation">,</span>  <span class="token number">0x37</span><span class="token punctuation">:</span><span class="token string">".>"</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span>   <span class="token punctuation">}</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">]</span>pos <span class="token operator">=</span> <span class="token number">0</span>os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'tshark -r location.pcap -T fields -e usb.capdata > d.txt'</span><span class="token punctuation">)</span>f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  d<span class="token operator">=</span>str<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  d<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">]</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"00"</span> <span class="token operator">or</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token operator">and</span> d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>a<span class="token punctuation">)</span>b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'k1'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>a<span class="token punctuation">)</span>b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token keyword">in</span> open<span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   c <span class="token operator">=</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># newline or down arrow - move down</span>   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x51</span> <span class="token operator">or</span> c <span class="token operator">==</span> <span class="token number">0x28</span><span class="token punctuation">:</span>       pos <span class="token operator">+=</span> <span class="token number">1</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># up arrow - move up</span>   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x52</span><span class="token punctuation">:</span>       pos <span class="token operator">-=</span> <span class="token number">1</span>       <span class="token keyword">continue</span>   <span class="token comment" spellcheck="true"># select the character based on the Shift key</span>   <span class="token keyword">if</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   <span class="token keyword">else</span><span class="token punctuation">:</span>       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>new_str <span class="token operator">=</span> <span class="token string">''</span>temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> letter <span class="token keyword">in</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">97</span> <span class="token operator">and</span> ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">122</span><span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chr<span class="token punctuation">(</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span> <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>letter<span class="token punctuation">)</span>new_str <span class="token operator">=</span> new_str<span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token keyword">print</span> new_str</code></pre><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><img src="/images/cyberwar/flag.png" alt="flag"></p><p>Flag: <strong>flag{war_never_changes}</strong></p><p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;USB leftover Capture data extraction.&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Writeups" scheme="https://bolisettynihith.github.io/categories/Writeups/"/>
    
      <category term="Network" scheme="https://bolisettynihith.github.io/categories/Writeups/Network/"/>
    
    
      <category term="Python" scheme="https://bolisettynihith.github.io/tags/Python/"/>
    
      <category term="Wireshark" scheme="https://bolisettynihith.github.io/tags/Wireshark/"/>
    
  </entry>
  
</feed>

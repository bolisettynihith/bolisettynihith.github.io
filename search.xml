<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>USB 2 - 2020 Defenit CTF</title>
    <url>/Defenit20-USB2/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Digging into windows registry to find process run counts and when it was run.</li>
<li>Extracting and parsing AmCache to find the hash of process images</li>
</ul>
<a id="more"></a>

<p>I have solved this challenge along with my teammate <a href="https://twitter.com/_abhiramkumar">stuxn3t</a> during the Defenit CTF.</p>
<h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/Defenit20-USB2/description.png" alt="Challenge-Description"></p>
<p>The challenge file can be downloaded from <a href="https://drive.google.com/drive/folders/1xWIDVxxr6gGL6w-7K2KNwDmanADfKMDW">Google Drive</a>.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with the file <code>usb.ad1</code>. From the extension, It was quite clear that the evidence was acquired via Access Data’s FTK Imager. So let us go ahead and load the file in FTK Imager with version &gt;=4.2.0.</p>
<p>We observe that only very few directories are present and our objective is to find the answer to the following questions so that we can combine them to get the flag. So let us dig in.</p>
<h2 id="Solution-for-Question-1"><a href="#Solution-for-Question-1" class="headerlink" title="Solution for Question 1"></a>Solution for Question 1</h2><pre class=" language-text"><code class="language-text">Question 1: Among the exe files, there are several files executed on the same USB. Let's call the second executed file 'A'. What is the name of 'A'?</code></pre>
<p>From the question we are clear that, we need to find what all processes were run when the USB was pluged in. As the system records all the events, we can look event logs and registry analysis.</p>
<p>However, we found the presence of <code>NTUSER.DAT</code> in the system. As the <code>NTUSER.dat</code> stores the software and operating system settings for each user profile. One can find <code>NTUSER.dat</code> in his user directory <code>[root]/Users/james</code></p>
<p><img src="/images/Defenit20-USB2/ntuser.png" alt="NTUSER.dat"></p>
<p>There are a lot of tools to view registry files. Here I am using Eric Zimmerman’s <strong>Registry Explorer</strong>.</p>
<p>In <code>NTUSER.data</code>, <code>UserAssist</code> is the registry key that stores the list of processes that were run, when it was run, how many times it was run. We can find all those values from this sub-key according to our system:</p>
<pre class=" language-text"><code class="language-text">Path: Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count</code></pre>
<p><img src="/images/Defenit20-USB2/userassist.png" alt="UserAssist"></p>
<p>To know which process was run on the USB, we first need to find when was the USB plugged in. For this, we use the <code>SYSTEM</code> registry to determine the <code>USB Last Arrival Date</code> time of the USB on the system. And that can be found from this sub-key:</p>
<pre class=" language-text"><code class="language-text">Path: ControlSet001\Enum\USBSTOR\Disk&Ven_SanDisk&Prod_Ultra&Rev_1.00\4C531001461206123040&0\Properties\{83da6326-97a6-4088-9453-a1923f573b29}\0066</code></pre>
<p><img src="/images/Defenit20-USB2/lastwrittentime.png" alt="Last Written time"></p>
<p>We can see the last write time as <code>2020-05-17 18.15.13</code>. So from this small detail, we can easily eliminate a lot of processes. However, we also found out that the USB was plugged-in/used ~ 18:00 Hrs as well. We found this from the <code>.lnk</code> files created in the system.</p>
<p><img src="/images/Defenit20-USB2/recentapps.png" alt="RecentApps"></p>
<p><code>.lnk</code> files are created whenever a file/folder is opened. In this case, we find a <strong>USB (E).lnk</strong> created on <code>2020-05-17 19:11:36 Hrs</code>.</p>
<p>So we can now identify the process. As we need to locate only 2 processes closest to this timestamp and the second one is the answer. On observing closely, we can see 2 processes are nearer to thae above timestamp.</p>
<table>
<thead>
<tr>
<th align="center">Program Name</th>
<th align="center">Run Counter</th>
<th align="center">Focus Count</th>
<th align="center">Focus Time</th>
<th align="center">Last Executed</th>
</tr>
</thead>
<tbody><tr>
<td align="center">E:\svchost.exe</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0d, 0h, 00m, 00s</td>
<td align="center">2020-05-17 19:11:00</td>
</tr>
<tr>
<td align="center">Microsoft.Windows.Explorer</td>
<td align="center">40</td>
<td align="center">109</td>
<td align="center">0d, 0h, 53m, 03s</td>
<td align="center">2020-05-17 19:10:13</td>
</tr>
</tbody></table>
<p>On looking the timestamps given by processes, I chose <code>svchost.exe</code></p>
<h2 id="solution-for-Question-2"><a href="#solution-for-Question-2" class="headerlink" title="solution for Question 2"></a>solution for Question 2</h2><pre><code>Question 2: How many times has &#39;A&#39; been executed?</code></pre><p>Since we have determined the which process is ‘A’ (svchost.exe), from the above table, we can get the answer to this question from the value specified in the <code>Run Counter</code> column, we can see that the svchost.exe was run <code>1</code> time.</p>
<h2 id="Solution-for-Question-3"><a href="#Solution-for-Question-3" class="headerlink" title="Solution for Question 3"></a>Solution for Question 3</h2><pre><code>Question 3: What is the sha-1 hash value of &#39;A&#39;?</code></pre><p>As we need the SHA-1 hash of <code>svchost.exe</code>, we can get the sha-1 hash from Sysmon records. As its not been enabled, we can get those details from the <code>Amcache.hve</code> file. Along with the SHA-1 hash, from the Amcahe.hve, we can also get recent processes that were run and lists the path of the files that’s executed which can then be used to find the executed program. Luckily, this file was present in the system.</p>
<p><strong>Path</strong>: <code>\%SystemRoot%\AppCompat\Programs\Amcache.hve</code></p>
<p>We can use Eric Zimmerman’s tool <a href="https://f001.backblazeb2.com/file/EricZimmermanTools/AmcacheParser.zip">AmcacheParser</a> to parse the files.</p>
<p>We extract the following files</p>
<ul>
<li>Amcache.hve</li>
<li>Amcache.hve.LOG1</li>
<li>Amcache.hve.LOG2</li>
</ul>
<p>Next, we powerup the PowerShell to properly parse the files into <code>.CSV</code> format.</p>
<p><img src="/images/Defenit20-USB2/amcache.png" alt="amcache"></p>
<p>The excel file required in this case is the <code>Amcache_UnassociatedFileEntries.csv</code>.</p>
<p><img src="/images/Defenit20-USB2/excel.png" alt="excel"></p>
<p>So we now have the SHA-1 hash of the file as: <code>d68960b8ecb374dd98ef6a33fed45dddd9796402</code></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>By concatenating all the 3 answers gives us the flag.</p>
<p><strong>FLAG</strong>: <code>Defenit{svchost.exe_1_d68960b8ecb374dd98ef6a33fed45dddd9796402}</code></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/">https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/</a></li>
</ul>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Windows Registry Analysis</category>
      </categories>
      <tags>
        <tag>Registry Analysis</tag>
        <tag>Amcache</tag>
      </tags>
  </entry>
  <entry>
    <title>Hackcon CTF’19 – Too cold for steg Writeup</title>
    <url>/Hackcon-CTF%E2%80%9919-%E2%80%93-Too-cold-for-steg-Writeup/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Whitespace steganography</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/Toocoldforsteg/description.png" alt="Description"></p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>Got a text file and opening the text file in any text editor and selecting all the text we can find some whitespace present at the ending of the each each line.</p>
<p>As the title is Too cold to steg we will get a tool known as stegsnow in our mind.</p>
<p>But for using the stegsnow we need a password. After searching for the password in the file given we can get the password as <strong>d4rkc0de-IIITD</strong>.</p>
<p><img src="/images/Toocoldforsteg/grep_password.png" alt="grep password"></p>
<p>Then using the stegsnow we will get the flag.</p>
<p><img src="/images/Toocoldforsteg/stegsnow.png" alt="stegsnow command"></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Flag: <strong>d4rk{h@ving_fun_w1th_st3gsn0w?}c0de</strong></p>
<p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Steganography</category>
      </categories>
      <tags>
        <tag>whitespace</tag>
      </tags>
  </entry>
  <entry>
    <title>Hackcon CTF’19 – GIMP IT Writeup</title>
    <url>/Hackcon-CTF%E2%80%9919-%E2%80%93-GIMP-IT-Writeup/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Analysing layers for an image</li>
<li>PIL</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/gimpit/description.png" alt="description"></p>
<p>As the challenge name suggests, use GIMP we will proceed with it. After opening the image in GIMP, we can see another layer in the image. So on choosing/making that layer visible we can see the content in that layer.</p>
<p><img src="/images/gimpit/layer_2_gimp.png" alt="layer 2"></p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We can see the “Nothing here” layer present in the image but we cannot understand the contents in it. These type of files also gives an additional advantage that the contents present in them are visible in original file data in form hex or in normal text. So after using strings we can see that there is a hex data present in it.</p>
<p><img src="/images/gimpit/strings_output.png" alt="strings output"></p>
<h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>The hex data is a zip file, so copying that data and making a file out it, we got an another file present in it. And that file contains of only 1’s and 0’s. First thought that it would an esolang(spoon) but didn’t anything. So there are somany 1’s and 0’s we thought of making an image from it. But we need the size of the image. And the len(whole binary string) is exactly the square of 370, we will use it as the image height &amp; width. Assuming 0 = (255, 255, 255) and 1 = (0, 0, 0).</p>
<p>So performed the operation in ipython and got an QR code. Here is the code;</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
t<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
im <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">370</span><span class="token punctuation">,</span><span class="token number">370</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
im<span class="token punctuation">.</span>putdata<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
im<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span></code></pre>
<p>On running the above code in python got a QR code and after scanning it got the flag.</p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Flag: <strong>d4rk{L0t5_0f_th1ng5_t0_d0_1n_th15_chAll@ng3}c0de</strong></p>
<p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Steganography</category>
      </categories>
      <tags>
        <tag>Steganography</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>DB64 - Poseidon CTF</title>
    <url>/DB64-Poseidon-CTF/</url>
    <content><![CDATA[<p>I have solved this challenge after the CTF. </p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are given with a windows 7 memory dump, lets start out initial analysis and check what all processes are running.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 pslist</code></pre>
<p><img src="pslist.png" alt="Process list"></p>
<p>We can see that <code>Google Chrome</code> and <code>Command Prompt</code> are active running process. So let us dig more into them and check whats there in them.</p>
<h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As we know each and every command we entered in command prompt are stored in conhost.exe and we can retrive those commands from volatility’s <code>consoles</code> plugin.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 consoles</code></pre>
<p><img src="/images/consoles.png" alt="consoles"></p>
<p>We can see “<code>I cant paste the binary in recyle bin</code>“ which gives us an information that we have to proceed to <code>pastebin</code> for the next step. But we need a random 8 letter character.</p>
<p>On going through some plugins, used <code>mimikatz</code> to get the user password. And found something similar to that random 8 letter character for pastebin.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 mimikatz</code></pre>
<p><img src="mimikatz.png" alt="mimikatz"></p>
<p>So on proceeding to this pastebin link(<a href="https://pastebin.com/dVi29Tv8">https://pastebin.com/dVi29Tv8</a>) and we can see a lot of strings of length 37. So it much be some kind of wordlist or something.</p>
<p>Let us check whats there in chrome history.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility --plugins<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Tools/volatility-plugins -f Based.raw --profile<span class="token operator">=</span>Win7SP1x64 chromehistory</code></pre>
<p><img src="chromehistory.png" alt="chrome history"></p>
<p>We can see that there is drive link(<a href="https://drive.google.com/file/d/1jYpvi9Va8be022G1SL4xUpEmZoknveTd/view">https://drive.google.com/file/d/1jYpvi9Va8be022G1SL4xUpEmZoknveTd/view</a>) is present and after opening it we found an <code>keepass</code> database.</p>
<p>For opening these keepass database we need a <code>Master Password</code> or <code>Key file</code>. But we can’t find one in the given memory, so as we know we can crack Keepass passwords with John the ripper and get the password if we have the correct wordlist.</p>
<p>Using the strings found in the pastebin as a wordlist we got the password.</p>
<p><img src="john_keepass.png" alt="John load hash"></p>
<p><img src="john_crack.png" alt="John Crack"></p>
<p>As I have already loaded the hash and its showed its already cracked. And we can see the cracked hashes also and we got the password as this <code>guz6AP41eXNZN6alCTZQsytzYsDSWrUV45lp</code> and after opening the keepass with that password we can see so many passwords already there in the database. From the username we can see that <code>Pastebin/KEY</code>. And the passwords are also something similar to 8 letter random characters needed for pastebin.</p>
<p><img src="keypass.png" alt="Keypass"></p>
<p>After going through them and we can see a long base64 string in all the pastebins and decoding those base64 strings and there are a lot of fake flag and in that one them is flag.</p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><img src="flag.png" alt="flag"></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Memory Forensics</category>
      </categories>
      <tags>
        <tag>Volatility</tag>
        <tag>Keepass</tag>
      </tags>
  </entry>
  <entry>
    <title>Lookout Foxy - InCTF Internationals 2020</title>
    <url>/InCTFi20-LookoutFoxy/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Decrypt the encrypted GPG file found in Outlook Express with the private key stored on the device.</li>
<li>Decrypt the firefox saved passwords and log in to the website that the terrorist used.</li>
</ul>
<a id="more"></a>

<p><strong>Challenge points</strong>: 627<br><strong>No. of solves</strong>: 30<br><strong>Challenge Author</strong>: <a href="https://twitter.com/NihithNihi">g4rud4</a></p>
<h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/LookoutFoxy/description.png" alt="Description"></p>
<p>You can download the challenge file from <a href="https://mega.nz/folder/MgtBHIhL#ChC7QdsEESP6_O-aALDSvw"><strong>Mega</strong></a> or <a href="https://drive.google.com/drive/folders/1EICM8RCZB4jHm63M6Y2Dua2Ir8zOaj5B?usp=sharing"><strong>Google Drive</strong></a></p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with an E01 file(Expert  Witness format image). There are a lot of ways in analyzing these files, I choose to use Autopsy for analyzing this. Let’s go ahead and load our E01 file in Autopsy. You can visit Autopsy’s<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> documentation if you don’t know how to add a data source to autopsy.</p>
<p>From the description, we have a clue that the terrorist is using a <strong>genuine chat client</strong>, lets see what all applications are installed in the device.</p>
<p>As we know, all the applications present on the device can be found in <code>Program Files</code>. Some of the applications we need to check are <code>GPG</code>, <code>Mozilla Firefox</code>, <code>NetMeeting</code>, <code>Outlook Express</code>. Let us dig more into it and check if they have identified and configured.</p>
<p><img src="/images/LookoutFoxy/applications.png" alt="applications"></p>
<p>So by checking application data, we can say that <code>Outlook Express</code> and <code>Mozilla Firefox</code> are configured. Let us dig more into them.</p>
<h2 id="First-part-solution"><a href="#First-part-solution" class="headerlink" title="First part solution"></a>First part solution</h2><p>As the Outlook Express is configured on the device, it leaves us useful forensics artifacts on the device.</p>
<p><img src="/images/LookoutFoxy/application_data.png" alt="application data"></p>
<p>Some of them are the mails received and sent. Whenever we receive a mail or delete a mail or sent a mail it will be stored in a <strong>.dbx files</strong>. Ex: for Inbox Emails - <code>inbox.dbx</code>, Sent Emails - <code>outbox.dbx</code> etc.</p>
<p>These files are stored at <code>C:\Documents and Settings\Crimson\Local Settings\Application Data\Identities\{random characters}\Microsoft\Outlook Express\</code></p>
<p>In our case, these are stored at <code>C:\Documents and Settings\Crimson\Local Settings\Application Data\Identities\{72F33BC6-0035-4FE0-AED1-5870C5CA389E}\Microsoft\Outlook Express\</code></p>
<p><img src="/images/LookoutFoxy/outlook_files.png" alt="Outlook Express files"></p>
<p>You can see .dbx files being listed there on right. We know that we can’t view the messages stored in <strong>DBX</strong> files. So I have converted the DBX file into a PDF file using this <a href="https://www.coolutils.com/online/DBX-to-PDF"><strong>link</strong></a>. There are other ways too, as this gives us something similar to the GUI, I used this. And one of the best thing is to do <code>strings</code> on the DBX files.</p>
<p>Converting the <code>Inbox.dbx</code> to PDF, One will be able to see that there is a mail from <code>David Banjamin davin.banjamin@gmail.com</code> with a subject <code>Secret File</code>. And a file named <code>secret.gpg</code> has been attached.</p>
<p><img src="/images/LookoutFoxy/inbox.png" alt="Outlook_Inbox"></p>
<p>We can get this file by a simple keyword search in Autopsy or check below.</p>
<p>So these attached files are stored in this location, unless the user saved it into a specified location <code>C:\Users\{username}\AppData\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5\{random characters}</code>.</p>
<p>We have 4 directories listed there, so rather than traversing through all directories, I used Autopsy’s <code>Web Downloads</code> Result. There we can see that there is a <code>secret.gpg.Zone.identifier</code> file. These <strong>Zone identifier</strong> files are generated automatically by applications/programs when files are downloaded to a Windows computer. So by checking the <code>Source file path</code> we can get the random characters. So going into that directory(<code>U0PDHEH3</code>), we can get the <code>secret.gpg</code> file easily.</p>
<p><img src="/images/LookoutFoxy/web_downloads.png" alt="Web Downloads Autopsy"></p>
<p><img src="/images/LookoutFoxy/temintfil.png" alt="Temporory internet files - secret.gpg"></p>
<p>We know that the gpg files can only be decrypted by the Owner’s private key. As we have seen a directory named <code>GPG</code> while traversing through the program files. Going into this directory we can find the <code>secret.key</code>.</p>
<p>Importing the private key and decrypting the encrypted GPG file, we can get the first half of the flag.</p>
<p><img src="/images/LookoutFoxy/gpg_import.png" alt="GPG Import"></p>
<pre class=" language-bash"><code class="language-bash">$ gpg --decrypt secret.gpg</code></pre>
<p>Snipping the output,</p>
<p><img src="/images/LookoutFoxy/firsthalfflag.png" alt="First half flag"></p>
<p>First half: <strong>inctf{!<strong>h0p3_y0u_L1k3d_s0lv1ng_7h3_F1rs7_p4r7</strong></strong></p>
<h2 id="Second-part-solution"><a href="#Second-part-solution" class="headerlink" title="Second part solution"></a>Second part solution</h2><p>As we see that there are a lot of web searches listed out in <code>Web History</code> results in Autopsy and going through them we can see a suspicious link <strong><a href="http://35.209.205.103/">http://35.209.205.103/</a></strong> in the history. So going to that link there is a login page. And there is a note saying <strong>Don’t brutefore the Password</strong>. So the password must be saved somewhere.</p>
<p><img src="/images/LookoutFoxy/login.png" alt="login"></p>
<p>As the terrorist is using firefox. And an active firefox installation will have a profile(in our case - <strong>5ztdm4br.default</strong>) which consists of a lot of forensics artifacts and that can be found generally at </p>
<blockquote>
<p><strong>Path</strong>: <code>C:\Documents and Settings\{Username}\Application Data\Mozilla\Firefox\{random characters}.default\</code></p>
</blockquote>
<p>In our case, these are found at</p>
<blockquote>
<p><strong>Path</strong>: <code>C:\Documents and Settings\Crimson\Application Data\Mozilla\Firefox\5ztdm4br.default\</code></p>
</blockquote>
<p>By Checking the <code>Web Form Autofill</code> results in Autopsy or by looking at the <strong>formhistory.sqlite</strong> database present in the firefox profile, we were able to see that the username as <strong>Danial_Banjamin</strong> and we need to find out the password.</p>
<p>As the username and password are stored in formhistory, that means passwords are stored in firefox saved passwords. We need to decrypt the saved passwords to get the original password.</p>
<p>Here comes the interesting part of decrypting Firefox saved passwords. There are a lot of ways</p>
<ol>
<li>By dumping the whole profile and passing the dumped folder location to firepwd<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> and a lot more.</li>
<li>By dumping only the required files from the profile.</li>
</ol>
<p>I am choosing the second way and here are those files:</p>
<ol>
<li><p><strong>logins.json</strong> - Place where all login information such as encrypted username and password are stored.</p>
</li>
<li><p><strong>cert8.db</strong> and <strong>key3.db</strong>/<strong>key4.db</strong> - These are encrypted SQLite database files, and the entries <code>encryptedUsername</code> and <code>encryptedPassword</code> found in logins.json are encrypted with the keys found in both databases.</p>
</li>
<li><p><strong>Permissions.sqlite</strong> - It contains permissions for installing add-ons, cookies, etc.</p>
</li>
</ol>
<p>After dumping all these files from the firefox profile mentioned above, I used <code>pwdecrypt</code> to decrypt the password. It’s a Debian package and can be installed by with apt.</p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> apt <span class="token function">install</span> libnss3-tools</code></pre>
<p>Then, I used a JSON parser(<code>jq</code>) to parse the JSON file and redirected the output to pwdecrypt.</p>
<p>Here is the json parsed output of logins.json.</p>
<pre class=" language-bash"><code class="language-bash">$ jq <span class="token keyword">.</span> <span class="token operator">&lt;</span> logins.json

<span class="token punctuation">{</span>
  <span class="token string">"nextId"</span><span class="token keyword">:</span> 3,
  <span class="token string">"logins"</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">"id"</span><span class="token keyword">:</span> 2,
      <span class="token string">"hostname"</span><span class="token keyword">:</span> <span class="token string">"http://35.209.205.103"</span>,
      <span class="token string">"httpRealm"</span><span class="token keyword">:</span> null,
      <span class="token string">"formSubmitURL"</span><span class="token keyword">:</span> <span class="token string">"http://35.209.205.103"</span>,
      <span class="token string">"usernameField"</span><span class="token keyword">:</span> <span class="token string">"username"</span>,
      <span class="token string">"passwordField"</span><span class="token keyword">:</span> <span class="token string">"password"</span>,
      <span class="token string">"encryptedUsername"</span><span class="token keyword">:</span> <span class="token string">"MDoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECOczOqq7/ZDYBBC7w84JwpxUfkx1Nw52VKlx"</span>,
      <span class="token string">"encryptedPassword"</span><span class="token keyword">:</span> <span class="token string">"MFoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECCwD7aXJGN+hBDAmr4dSU/2vXn+H+TZDl+oTlLGPMbX4usiAkneTan114d6kB2GGUa2b6771U5YIU40="</span>,
      <span class="token string">"guid"</span><span class="token keyword">:</span> <span class="token string">"{3ff55df0-bbb8-4192-98df-a1f428964c31}"</span>,
      <span class="token string">"encType"</span><span class="token keyword">:</span> 1,
      <span class="token string">"timeCreated"</span><span class="token keyword">:</span> 1595695030340,
      <span class="token string">"timeLastUsed"</span><span class="token keyword">:</span> 1595858974764,
      <span class="token string">"timePasswordChanged"</span><span class="token keyword">:</span> 1595695030340,
      <span class="token string">"timesUsed"</span><span class="token keyword">:</span> 2
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>,
  <span class="token string">"disabledHosts"</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
  <span class="token string">"version"</span><span class="token keyword">:</span> 2
<span class="token punctuation">}</span></code></pre>
<p>As we are having so many entries, and we only need the username, password and URL. So added those entries to json parser and redirected it to <strong>pwdecrypt</strong>.</p>
<pre class=" language-bash"><code class="language-bash">$ jq -r -S <span class="token string">'.logins[] | .hostname, .encryptedUsername, .encryptedPassword'</span> logins.json <span class="token operator">|</span> pwdecrypt -d <span class="token keyword">.</span>

http://35.209.205.103
Decrypted: <span class="token string">"Danial_Banjamin"</span>
Decrypted: <span class="token string">"2!6BQ&amp;e626g#YNWxsQWV9^knO8#85*E%6Zaxr@At42"</span></code></pre>
<p>As the master password was not set by the terrorist we were able to get the decrypted password. So logging in using those credentials gives the second part of the flag.</p>
<p><img src="/images/LookoutFoxy/second_part.png" alt="second part"></p>
<p>Second Part of the flag: <strong>4nd_3njoy3d_7he_53c0nd_p4rt_0f_7h3_ch4ll3ng3}</strong></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>By concatinating two parts, here is the final flag:<br><strong>inctf{!_h0p3_y0u_L1k3d_s0lv1ng_7h3_F1rs7_p4r7_4nd_3njoy3d_7he_53c0nd_p4rt_0f_7h3_ch4ll3ng3}</strong></p>
<p>If you have any queries, Feel free to ping me. I am available on Twitter <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>Here are some of the resources I came up while making the challenge. Hope it will be useful.</p>
<ul>
<li><a href="https://blog.tajuma.com/?p=35">https://blog.tajuma.com/?p=35</a></li>
<li><a href="http://raidersec.blogspot.com/2013/06/how-browsers-store-your-passwords-and.html">http://raidersec.blogspot.com/2013/06/how-browsers-store-your-passwords-and.html</a></li>
<li><a href="http://media.blackhat.com/bh-us-11/Bursztein/BH_US_11_Bursztein_Owade_Slides.pdf">http://media.blackhat.com/bh-us-11/Bursztein/BH_US_11_Bursztein_Owade_Slides.pdf</a></li>
</ul>
<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">https://sleuthkit.org/autopsy/docs/user-docs/4.3/ds_page.html</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">https://github.com/lclevy/firepwd</span><a href="#fnref:2" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
      <categories>
        <category>Forensics</category>
        <category>Disk</category>
      </categories>
      <tags>
        <tag>Autopsy</tag>
        <tag>InCTFi</tag>
      </tags>
  </entry>
  <entry>
    <title>HackTM Quals 20 – Find my Pass Writeup</title>
    <url>/HackTM-Quals-20%E2%80%93Find-my-Pass-Writeup/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Memory dump analysis using Volatility.</li>
<li>Extracting Keepass Master Password from the memory.</li>
<li>Extracting flag from ZIP archive attached in the Keepass database.</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>I managed to forget my password for my KeePass Database but luckily I had it still open and managed to get a dump of the system’s memory. Can you please help me recover my password?</p>
<p>Challenge file: <a href="https://mega.nz/#!IdUVwY6I!uJWGZ932xab44H4EJ-zVAqu6_UWNJcCVA4_PPXdqCyc">Mega Drive</a> or <a href="https://drive.google.com/open?id=1hUlGqJZYgbWaEu7w0JnPMqgYdFr8qVJe">Google Drive</a></p>
<p>Password: <strong>eD99mLkU</strong></p>
<p>Hint: I am not very good with computers, I use my one safe password where I want to keep everything safe from hackers.</p>
<p>I solved this challenge after the CTF has ended.</p>
<p>According to the description, In this challenge, we have to retrieve the Master Password of a Keepass database from the memory.</p>
<h2 id="Initial-Anaysis"><a href="#Initial-Anaysis" class="headerlink" title="Initial Anaysis"></a>Initial Anaysis</h2><p>First, you need to find what OS his system was using. For that, I used imageinfo plugin.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem imageinfo</code></pre>
<p><img src="/images/Find-my-Pass/imageinfo.png" alt="Imageinfo Output"></p>
<p>I choose <strong>Win7SP1x86</strong> profile.<br>Let’s check what all processes are running in the system. We can expect that keepass.exe will be present, as the description says that the database was kept open.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 pslist</code></pre>
<p><img src="/images/Find-my-Pass/pslist_1.png" alt="pslist output"><br><img src="/images/Find-my-Pass/pslist_2.png" alt="pslist output"></p>
<p>We can see that the keepass.exe process was running and going further.</p>
<h2 id="Extracting-Keepass-database"><a href="#Extracting-Keepass-database" class="headerlink" title="Extracting Keepass database"></a>Extracting Keepass database</h2><p>We need to find the .kdbx file as all KeePass databases are stored with extension .kdbx. For that, we will use filescan plugin and grep for kdbx files.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 filescan <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">".kdbx"</span></code></pre>
<p><img src="/images/Find-my-Pass/kdbx_filescan.png" alt="Filescan Kdbx"></p>
<p>We can see a database.kdbx was open and the further step is to dump that file to our host system. For that, we will use dumpfiles plugin.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 dumpfiles -Q 0x000000007df37c88 -D <span class="token keyword">.</span></code></pre>
<p><img src="/images/Find-my-Pass/kdbx_dumpfiles.png" alt="Dumpfiles kdbx"></p>
<p>When I attempted to open the database, it asked for the master password. The description says that the user has forgotten his password which means we have to recover it.</p>
<h2 id="Retriving-Master-Password"><a href="#Retriving-Master-Password" class="headerlink" title="Retriving Master Password"></a>Retriving Master Password</h2><p>But the hint says user used the same password everywhere ie: he must have copied the password and user it somewhere else. So let’s check what’s there in his clipboard. For that, we use the clipboard plugin.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 clipboard</code></pre>
<p><img src="/images/Find-my-Pass/clipboard.png" alt="Clipboard"></p>
<p>We can’t find anything in the clipboard. It seems to be suspicious. So let’s check the verbose data of the clipboard.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f HackTM.vmem --profile<span class="token operator">=</span>Win7SP1x86 clipboard -v</code></pre>
<p><img src="/images/Find-my-Pass/clipboard-v.png" alt="clipboard -v"></p>
<p>Hurrah! We found it.</p>
<p>By removing the dots and using it (<strong>dmVZQmdzOlUrcEBlRj87dHQ3USVBIn</strong>) as the master password we got into the Keepass database.</p>
<p>In the bottom, in attachments, we can see that there is <strong>nothinghere.7z</strong> file that was attached to the password entry.</p>
<p>We can extract that from the <strong>File Attachments</strong> in the <strong>Advanced tab</strong> of <strong>Edit Entry</strong>.</p>
<p>The 7z file asked for a password and on using the database master password we successfully extracted the text file. It contained the flag.</p>
<p>Flag: <strong>HackTM{d14c02244b17f4f9dfc0f71ce7ab10e276a5880a05fca64d39a716bab92cda90}</strong></p>
<p>The another way of solving this challenge is mentioned in <a href="https://blog.bi0s.in/2020/02/09/Forensics/HackTM-FindMyPass/">blog.bi0s.in</a> by my mentor <a href="https://twitter.com/_abhiramkumar">@_abhiramkumar</a>.</p>
<p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Memory Forensics</category>
      </categories>
      <tags>
        <tag>Volatility</tag>
        <tag>Memory</tag>
      </tags>
  </entry>
  <entry>
    <title>Securinets CTF’19 – Rare to win Writeup</title>
    <url>/Securinets-CTF%E2%80%9919-%E2%80%93-Rare-to-win-Challenge/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Chrome history analysis</li>
<li>ACE file analysis</li>
<li>Detecting the virus</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/Raretowin/description.png" alt="Description"></p>
<p>I could not solve this challenge at the time of the CTF. But it is a nice challenge.</p>
<p>Given with an Windows 7 memory dump, lets see what all processes are running in the machine/system.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>As the description of the says that the operator was browsing web the he might be using one of the browsers like Chrome, Firefox, or inbuilt Explorer. So lets go and see the pslist.</p>
<p><img src="/images/Raretowin/pslist.png" alt="PSlist output"></p>
<p>As we can see that chrome was running in system at the time when the dump was captured. So as the Chrome was running in the system we can use chrome history plugin and get the users history data.</p>
<p><img src="/images/Raretowin/chromehistory.png" alt="Chrome History"></p>
<h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As we can see that, there is file called <strong>music.rar</strong> was downloaded from the chrome. So we will search for the file in the dump, using filescan plugin.</p>
<p><img src="/images/Raretowin/filescan_music_rar.png" alt="filescan_music_rar"></p>
<p>It resulted that there is no file relating to it. So I have downloaded the file from the <a href="https://www.mediafire.com/file/2t7bb2mflg2lwwj/music.rar/file">link</a> he browsed.</p>
<p>I tried opening the rar but it does not shown any files and it was in <strong>Read Only</strong> mode. So tried running <strong>file command</strong> on it and got to know that it is an <strong>ACE</strong> file.</p>
<p><img src="/images/Raretowin/file_music.png" alt="file command"></p>
<p>After a quick search in google, i came to know that there are some tools to open and extract the file from the ace file. So I renamed it and tried the unace command line tool which was provided by the Ubuntu software. But it doesn’t gave any results. So I checked for other alternatives and found <a href="http://webdiis.unizar.es/pub/unix/archive/linunace25.tgz">this</a>.</p>
<p>After using that tool, I can see that there is a firefox.exe and it is unable to override the build in firefox of the host system as I didn’t run with sudo permission.</p>
<p><img src="/images/Raretowin/unace.png" alt="unace"></p>
<p>And also if we use binwalk on the that ace file, we can see an <strong>ELF</strong> file present in it. And loading that in gdb and seeing the main function of the elf, there is only one operation going on that is the <strong>printf function</strong>. So we can say that the exe was the <strong>virus</strong> that the challenge author has asked.</p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>But the flag is the <strong>path_to_the_virus</strong>. So as we can see that the exe file was extracting to <strong>C:/Users/Public/Data/firefox.exe</strong> therefore that will be the path that they have asked.</p>
<p>But in windows the folders are divided using “\\” so the resulting path is <strong>C:\\Users\\Public\\Data\\firefox.exe</strong>.</p>
<p>And the flag will be,</p>
<p>Flag : <strong>securinets{84117b4eb400242a9db464e84220e672}</strong></p>
<p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Memory Forensics</category>
      </categories>
      <tags>
        <tag>Volatility</tag>
        <tag>Memory</tag>
      </tags>
  </entry>
  <entry>
    <title>Fresh From The Oven - InCTF Internationals 2019 Writeup</title>
    <url>/InCTFi19-Fresh-From-the-Oven/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Decoding the strings found in TCP stream 0.</li>
<li>Analysing and extracting data sent via different ports of TCP.</li>
<li>Using character-wise caesar from the extracted data.</li>
<li>Zip cracking</li>
</ul>
<a id="more"></a>

<h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/images/FreshFromtheOven/description.png" alt="Description"></p>
<p>You can download the challenge file from <a href="https://mega.nz/#!d6wEFICJ!u9XykRdIoJtloYDZQxFqXt1KvWR5aK3Ucisd2-a-qms"><strong>Mega</strong></a> or <a href="https://drive.google.com/file/d/1ZBLNYqFOA0dOx8e1GnNoO3qn2V0Elpcm/view?usp=sharing"><strong>G-Drive</strong></a></p>
<p>This is a challenge which I made for InCTFi’19 along with my teammate(<a href="https://twitter.com/__Sh4d0w__">@Sh4d0w</a>).</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with a <strong>pcap</strong> file. Let’s start our initial analysis.</p>
<p>We can see so many TCP packets in the capture file and the description says that it was a chat between two friends. So let’s follow the TCP stream and see if anything is interesting in it.</p>
<p><img src="/images/FreshFromtheOven/tcp-stream-0.png" alt="TCP Stream"></p>
<p>We do see a chat between 2 people. Also, we can find some encoded strings. The secret code: <strong>Remember remember the FIFTH of november :)</strong> does hint out something. We can assume the encoded strings are <strong>ROT5</strong>. Decoding them, we get;</p>
<pre><code>Rohith: This is a sample in that encoded way.

Shyam: Oh, It&#39;s good and it took a lot of time to understand for me.

Rohith: Sending you some interesting files, try to find the secret behind them and keep it confidential

Shyam: Okay, sure:)</code></pre><h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>As the chat between them says that some files have transferred. And we can see that from <strong>TCP Stream 2</strong>, extra data with <strong>800 bytes</strong> is transferred in two different destination ports(<strong>444</strong> &amp; <strong>81</strong>). We can assume that the two files have been transferred.</p>
<p>Extracting the data sent to the above-mentioned ports and applying <strong>Caesar cipher</strong> on the two files, we get the file structure of a <strong>PDF file</strong> and a <strong>ZIP file</strong>.</p>
<p><img src="/images/FreshFromtheOven/file_pdf.png" alt="File PDF"></p>
<p><img src="/images/FreshFromtheOven/file_zip.png" alt="File zip"></p>
<p>After opening the PDF and we find extra spaces in the last page of that file. It says “<strong>NOTHING HERE :( DON’T WASTE YOUR TIME</strong>“.</p>
<p>So it’s just a <strong>rabbit hole</strong>.</p>
<p>After a brief observation, we see that the ZIP is password protected. So, we use <strong>fcrackzip</strong> in dictionary mode to crack the password,</p>
<p><img src="/images/FreshFromtheOven/zip_cracking.png" alt="zip cracking"></p>
<p>The password is <strong>johnjandroveclarkmichaelkent</strong>.</p>
<p>Extracting the file from the zip gave a <strong>PNG</strong> image.</p>
<p><img src="/images/FreshFromtheOven/flag.png" alt="flag"></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>Simple LSB steg can be used to get the flag. We used the popular tool <strong>zsteg</strong> for this.</p>
<p>FLAG: <strong>inctf{3ach_4nd_3v3ry_s3cre7_inf0rm4t10n_w1ll_b3_kn0wn_by_wir3shark!!!!!_:)}</strong></p>
<p>If you like my solution, please do share it. I’m availabe on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Network</category>
      </categories>
      <tags>
        <tag>Steganography</tag>
        <tag>Wireshark</tag>
      </tags>
  </entry>
  <entry>
    <title>Securinets-CTF’20–Time-Matters</title>
    <url>/Securinets-CTF%E2%80%9920%E2%80%93Time-Matters/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>chrome history analysis</li>
<li>File recovery from memory dump</li>
<li>Simple stego</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="/images/TimeMatters/description.png" alt="Description"></p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are given with a Windows 7 memory dump. Let’s see what all processes are running in the macine.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 pslist</code></pre>
<p><img src="/images/TimeMatters/pslist.png" alt="PSList"></p>
<p>We can see Explorer and chrome are in open, lets check what’s there in Chrome’s history. We know that for their is a plugin <strong>chromehistory</strong>, we will use that.</p>
<pre class=" language-bash"><code class="language-bash">volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 chromehistory</code></pre>
<p><img src="/images/TimeMatters/chromehistory.png" alt="chrome history"></p>
<p>We didn’t find any suspicious links in chrome’s history. </p>
<h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>So let’s check what all files are there in the system.</p>
<pre class=" language-bash"><code class="language-bash">volatility --plugins<span class="token operator">=</span>/home/g4rud4/Downloads/Tools/volatility-plugins -f for1.raw --profile<span class="token operator">=</span>Win7SP1x86_23418 filescan <span class="token operator">|</span> <span class="token function">grep</span> Desktop</code></pre>
<p><img src="/images/TimeMatters/filescan_desktop.png" alt="Filescan Desktop"></p>
<p>We can steghide and a jpg image on the desktop, So let’s dumpfile the jpg file and use steghide on it.</p>
<p><img src="/images/TimeMatters/dumpfiles.png" alt="dumpfiles"></p>
<p>When I used steghide for extaction, it asked for the password, I followed the same way as everyone does, just leaving it <strong>blink</strong> and clicking <strong>Enter</strong>. But no use.</p>
<p><img src="/images/TimeMatters/steghide_wop.png" alt="Steghide Without PSSWD"></p>
<p>So I thought to use the users password and got the NTLM hash using hashdump, but when cracked hash didn’t gave the result.</p>
<p><img src="/images/TimeMatters/hashdump.png" alt="hashdump"> <img src="/images/TimeMatters/crackstation.png" alt="crackstation"></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>So after opening the image, it’s Messi’s image which was took on 2019. So the on looking at the challenge titile and relating that to the password of steghide, we can use <strong>Messi2019</strong> as password and try what we can get.</p>
<p><img src="/images/TimeMatters/DS0394.jpg" alt="Messi Image"><br><img src="/images/TimeMatters/steghide_2.png" alt="Using Messi2019 as Password"></p>
<p>Hoorah!! We got the output. One opening the resulted image, we got the flag.</p>
<p><img src="/images/TimeMatters/image.png" alt="Flag"></p>
<p>There is an other way also, by using <strong>mimikatz</strong> for getting the user password. But when I used the password that we got in <strong>mimikatz</strong>, I didn’t got anything, so after modifing the password by relating to the challenge title and modifying it to <strong>Messi2020</strong>, we can get the flag.</p>
<p><img src="/images/TimeMatters/mimikatz.png" alt="mimikatz"><br><img src="/images/TimeMatters/steghide_1.png" alt="using Messi2020 as password"></p>
<p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Memory Forensics</category>
      </categories>
      <tags>
        <tag>Volatility</tag>
        <tag>Memory</tag>
      </tags>
  </entry>
  <entry>
    <title>Swamp CTF’18 – Orcish Writeup</title>
    <url>/Swamp-CTF%E2%80%9918-%E2%80%93-Orcish-challenge/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>Analysing ICMP type field and extracting GIF file</li>
</ul>
<a id="more"></a>

<h2 id="Descritpion"><a href="#Descritpion" class="headerlink" title="Descritpion"></a>Descritpion</h2><p><img src="/images/orcish/description.png" alt="Description"></p>
<p>This is a good challenge and very useful challenge for learning about Networking and it’s related concepts.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>In this challenge on opening the pcap file and checking the protocol hierarchy, we can see so many protocols are present in it.</p>
<p><img src="/images/orcish/protocol_hiercy.png" alt="Protocol Hierarchy"></p>
<p>As usually, as there are so many HTTP and TCP packets in that, so using the Export objects we can extract the HTTP data from the packets. But could not find anything interesting from that. As we know that the same HTTP data is transferred via TCP also no need of extracting the TCP data from the TCP packets. I have wasted a lot of time in analysing those data and those packets.</p>
<p>After going into ICMP packets, we can see the <strong>GIF file signature(GIF89a)</strong>, splitted through upcoming packets. So we can assume that a <strong>GIF file</strong> is transferred in ICMP packets.</p>
<p><img src="/images/orcish/gif_1.png" alt="first byte"> <img src="/images/orcish/gif_2.png" alt="second byte"> <img src="/images/orcish/gif_3.png" alt="third byte"> <img src="/images/orcish/gif_4.png" alt="forth byte"> <img src="/images/orcish/gif_5.png" alt="fifth byte"> <img src="/images/orcish/gif_6.png" alt="sixth byte"></p>
<h2 id="Further-Analysis"><a href="#Further-Analysis" class="headerlink" title="Further Analysis"></a>Further Analysis</h2><p>So, we know that scapy a powerful packet manipulation program. Extracting the specified packets(ICMP) and reading the packet through scapy, we can see that, type layer of the ICMP packets was transferring the data.</p>
<p><img src="/images/orcish/display_scapy.png" alt="Load Scapy"></p>
<p>So, I have written an exploit script, to get the whole required data <strong>(ICMP type)</strong> from the ICMP packets. You need to export all the ICMP packets and save it as <strong>exported.pcap</strong>, and run the script below.</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span>all <span class="token keyword">import</span> <span class="token operator">*</span>
f<span class="token operator">=</span>rdpcap<span class="token punctuation">(</span><span class="token string">'exported.pcap'</span><span class="token punctuation">)</span>
x<span class="token operator">=</span><span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x<span class="token operator">+=</span>chr<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span>

b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'flag.gif'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>After running the above code it will create a new file named <strong>flag.gif</strong> and after opening it we got the flag.</p>
<p><img src="/images/orcish/flag.gif" alt="Flag"></p>
<p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Network</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Wireshark</tag>
        <tag>Network</tag>
      </tags>
  </entry>
  <entry>
    <title>Swamp CTF’19 - The Cyber War Continues Writeup</title>
    <url>/Swamp-CTF%E2%80%9919-The-Cyber-War-Continues/</url>
    <content><![CDATA[<p><strong>tl;dr</strong></p>
<ul>
<li>USB leftover Capture data extraction.</li>
</ul>
<a id="more"></a>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p>As you and your convoy circle the barren lands on your light cycles you notice something strange in the distance. Upon further investigation you find what seems to be the remnants of a battle.</p>
<p>Bodies, robotic and organic alike, are strewn all over the place. You begin scavenging for supplies and weapons, suddenly a man near death thrusts his hand and grabs your arm. “Please” he croaks, “find my friends”.</p>
<p>He hands you a USB as he takes his last breath. You plug the drive into your mechanical arm and the contents start flooding your HUD. It contains this message and an encrypted file.</p>
</blockquote>
<p>Click <a href="https://drive.google.com/drive/u/0/folders/1dTzkvMUmiqKmtkBgyFevXob9WOXsCZQA">here</a>, to download challenge file.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>In this challenge we got a 7z file which was password protected and a text file. I don’t know why they have given that text file, as of now my aim was to crack the password for the ‘7z file’.</p>
<p><img src="/images/cyberwar/7z.png" alt="Protected 7z"></p>
<p>So, I used an <a href="https://www.lostmypass.com/file-types/7z/">online tool</a> to crack the 7z password. And it gave me the password as “toor”, using this as the password for the archive and extracting it, got a pcap.</p>
<p><img src="/images/cyberwar/pcap.png" alt="Display pcap"></p>
<p>On analysing that pcap file, all the packets present in that pcap file are related to USB Protocol and on observing the left over capture data got to know that it was based on the keyboard Strokes.</p>
<h2 id="Futher-Analysis"><a href="#Futher-Analysis" class="headerlink" title="Futher Analysis"></a>Futher Analysis</h2><p>So, on googling found a <a href="https://bitvijays.github.io/LFC-Forensics.html">script</a> for USB Keyboard Strokes and i have rewritten that code such that it will automate all the process we do manually and will give the flag out. The code follows,</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os
usb_codes <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token number">0x04</span><span class="token punctuation">:</span><span class="token string">"aA"</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">:</span><span class="token string">"bB"</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">:</span><span class="token string">"cC"</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">:</span><span class="token string">"dD"</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">:</span><span class="token string">"eE"</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">:</span><span class="token string">"fF"</span><span class="token punctuation">,</span>
   <span class="token number">0x0A</span><span class="token punctuation">:</span><span class="token string">"gG"</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">:</span><span class="token string">"hH"</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">:</span><span class="token string">"iI"</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">:</span><span class="token string">"jJ"</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">:</span><span class="token string">"kK"</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">:</span><span class="token string">"lL"</span><span class="token punctuation">,</span>
   <span class="token number">0x10</span><span class="token punctuation">:</span><span class="token string">"mM"</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">:</span><span class="token string">"nN"</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">:</span><span class="token string">"oO"</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">:</span><span class="token string">"pP"</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">:</span><span class="token string">"qQ"</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">:</span><span class="token string">"rR"</span><span class="token punctuation">,</span>
   <span class="token number">0x16</span><span class="token punctuation">:</span><span class="token string">"sS"</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">:</span><span class="token string">"tT"</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">:</span><span class="token string">"uU"</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">:</span><span class="token string">"vV"</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">:</span><span class="token string">"wW"</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">:</span><span class="token string">"xX"</span><span class="token punctuation">,</span>
   <span class="token number">0x1C</span><span class="token punctuation">:</span><span class="token string">"yY"</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">:</span><span class="token string">"zZ"</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">:</span><span class="token string">"1!"</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">:</span><span class="token string">"2@"</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">:</span><span class="token string">"3#"</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">:</span><span class="token string">"4$"</span><span class="token punctuation">,</span>
   <span class="token number">0x22</span><span class="token punctuation">:</span><span class="token string">"5%"</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">:</span><span class="token string">"6^"</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">:</span><span class="token string">"7&amp;"</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">:</span><span class="token string">"8*"</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">:</span><span class="token string">"9("</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">:</span><span class="token string">"0)"</span><span class="token punctuation">,</span>
   <span class="token number">0x2C</span><span class="token punctuation">:</span><span class="token string">"  "</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">:</span><span class="token string">"-_"</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">:</span><span class="token string">"=+"</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">:</span><span class="token string">"[{"</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">:</span><span class="token string">"]}"</span><span class="token punctuation">,</span>  <span class="token number">0x32</span><span class="token punctuation">:</span><span class="token string">"#~"</span><span class="token punctuation">,</span>
   <span class="token number">0x33</span><span class="token punctuation">:</span><span class="token string">";:"</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">:</span><span class="token string">"'\""</span><span class="token punctuation">,</span>  <span class="token number">0x36</span><span class="token punctuation">:</span><span class="token string">",&lt;"</span><span class="token punctuation">,</span>  <span class="token number">0x37</span><span class="token punctuation">:</span><span class="token string">".>"</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span>
   <span class="token punctuation">}</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">]</span>

pos <span class="token operator">=</span> <span class="token number">0</span>

os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'tshark -r location.pcap -T fields -e usb.capdata > d.txt'</span><span class="token punctuation">)</span>

f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  d<span class="token operator">=</span>str<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  d<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"00"</span> <span class="token operator">or</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token operator">and</span> d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>

a<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>a<span class="token punctuation">)</span>

b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'k1'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> open<span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   c <span class="token operator">=</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> 
   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># newline or down arrow - move down</span>
   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x51</span> <span class="token operator">or</span> c <span class="token operator">==</span> <span class="token number">0x28</span><span class="token punctuation">:</span>
       pos <span class="token operator">+=</span> <span class="token number">1</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># up arrow - move up</span>
   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x52</span><span class="token punctuation">:</span>
       pos <span class="token operator">-=</span> <span class="token number">1</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># select the character based on the Shift key</span>
   <span class="token keyword">if</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
   <span class="token keyword">else</span><span class="token punctuation">:</span>
       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></code></pre>
<p>After running the above code for USB keyboard hid keys, got an output as some random string,</p>
<p><img src="/images/cyberwar/random_string.png" alt="Random String"></p>
<p>The random string is : <strong>synt{jne_arire_punatrf}</strong></p>
<p>I understood that random string was a <strong>Caesar Cipher</strong>. So I re-modified the above code such a way that we get the deciphered flag as we can see that the difference between <strong>s</strong> and <strong>f</strong> is <strong>13</strong>, so I remodified like that. Modified code is,</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os
usb_codes <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token number">0x04</span><span class="token punctuation">:</span><span class="token string">"aA"</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">:</span><span class="token string">"bB"</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">:</span><span class="token string">"cC"</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">:</span><span class="token string">"dD"</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">:</span><span class="token string">"eE"</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">:</span><span class="token string">"fF"</span><span class="token punctuation">,</span>
   <span class="token number">0x0A</span><span class="token punctuation">:</span><span class="token string">"gG"</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">:</span><span class="token string">"hH"</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">:</span><span class="token string">"iI"</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">:</span><span class="token string">"jJ"</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">:</span><span class="token string">"kK"</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">:</span><span class="token string">"lL"</span><span class="token punctuation">,</span>
   <span class="token number">0x10</span><span class="token punctuation">:</span><span class="token string">"mM"</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">:</span><span class="token string">"nN"</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">:</span><span class="token string">"oO"</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">:</span><span class="token string">"pP"</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">:</span><span class="token string">"qQ"</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">:</span><span class="token string">"rR"</span><span class="token punctuation">,</span>
   <span class="token number">0x16</span><span class="token punctuation">:</span><span class="token string">"sS"</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">:</span><span class="token string">"tT"</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">:</span><span class="token string">"uU"</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">:</span><span class="token string">"vV"</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">:</span><span class="token string">"wW"</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">:</span><span class="token string">"xX"</span><span class="token punctuation">,</span>
   <span class="token number">0x1C</span><span class="token punctuation">:</span><span class="token string">"yY"</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">:</span><span class="token string">"zZ"</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">:</span><span class="token string">"1!"</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">:</span><span class="token string">"2@"</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">:</span><span class="token string">"3#"</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">:</span><span class="token string">"4$"</span><span class="token punctuation">,</span>
   <span class="token number">0x22</span><span class="token punctuation">:</span><span class="token string">"5%"</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">:</span><span class="token string">"6^"</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">:</span><span class="token string">"7&amp;"</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">:</span><span class="token string">"8*"</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">:</span><span class="token string">"9("</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">:</span><span class="token string">"0)"</span><span class="token punctuation">,</span>
   <span class="token number">0x2C</span><span class="token punctuation">:</span><span class="token string">"  "</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">:</span><span class="token string">"-_"</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">:</span><span class="token string">"=+"</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">:</span><span class="token string">"[{"</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">:</span><span class="token string">"]}"</span><span class="token punctuation">,</span>  <span class="token number">0x32</span><span class="token punctuation">:</span><span class="token string">"#~"</span><span class="token punctuation">,</span>
   <span class="token number">0x33</span><span class="token punctuation">:</span><span class="token string">";:"</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">:</span><span class="token string">"'\""</span><span class="token punctuation">,</span>  <span class="token number">0x36</span><span class="token punctuation">:</span><span class="token string">",&lt;"</span><span class="token punctuation">,</span>  <span class="token number">0x37</span><span class="token punctuation">:</span><span class="token string">".>"</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span>
   <span class="token punctuation">}</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">]</span>

pos <span class="token operator">=</span> <span class="token number">0</span>

os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'tshark -r location.pcap -T fields -e usb.capdata > d.txt'</span><span class="token punctuation">)</span>

f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  d<span class="token operator">=</span>str<span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  d<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"00"</span> <span class="token operator">or</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token operator">and</span> d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>

a<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>a<span class="token punctuation">)</span>

b<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'k1'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>
b<span class="token punctuation">.</span>write<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
b<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> open<span class="token punctuation">(</span><span class="token string">"k1"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   c <span class="token operator">=</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>

   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># newline or down arrow - move down</span>
   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x51</span> <span class="token operator">or</span> c <span class="token operator">==</span> <span class="token number">0x28</span><span class="token punctuation">:</span>
       pos <span class="token operator">+=</span> <span class="token number">1</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># up arrow - move up</span>
   <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token number">0x52</span><span class="token punctuation">:</span>
       pos <span class="token operator">-=</span> <span class="token number">1</span>
       <span class="token keyword">continue</span>
   <span class="token comment" spellcheck="true"># select the character based on the Shift key</span>
   <span class="token keyword">if</span> int<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
   <span class="token keyword">else</span><span class="token punctuation">:</span>
       l<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">+=</span> usb_codes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

new_str <span class="token operator">=</span> <span class="token string">''</span>
temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> letter <span class="token keyword">in</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">97</span> <span class="token operator">and</span> ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">122</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chr<span class="token punctuation">(</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ord<span class="token punctuation">(</span>letter<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span> <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">else</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>letter<span class="token punctuation">)</span>
new_str <span class="token operator">=</span> new_str<span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>

<span class="token keyword">print</span> new_str</code></pre>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><img src="/images/cyberwar/flag.png" alt="flag"></p>
<p>Flag: <strong>flag{war_never_changes}</strong></p>
<p>If you liked my solution, please do share it. I’m available on Twitter: <a href="https://twitter.com/NihithNihi">@NihithNihi</a></p>
]]></content>
      <categories>
        <category>Writeups</category>
        <category>Network</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Wireshark</tag>
      </tags>
  </entry>
  <entry>
    <title>Mapping the Digits - Week 1 - Magnet Weekly CTF</title>
    <url>/Magnet-Weekly-CTF/Mapping-the-Digits-Week-1-Magnet-Weekly-CTF/</url>
    <content><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><img src="description.png" alt=""></p>
<p>As the description says, we need to find the last modified time of a file that maps DNS names to IP’s recently accessed.</p>
<p>I don’t have much knowledge on Mobile Forensics. It is time to sharen my skills on Mobile Forensics. Magnet Forensics has decided for a weekly CTF, new challenge every Monday for the last quarter of 2020. You can find more info in the <a href="https://www.magnetforensics.com/blog/magnet-weekly-ctf-challenge/">blog post</a> released by Magnet Forensics.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>With my limited experience in Mobile Forensics, I started to look for <strong>hosts</strong> file as it is responsible for mapping IP’s to DNS names(Similar to Windows and Linux).</p>
<p>Let’s go a head and load the Android Image in Autopsy. You can download the image <a href="https://drive.google.com/file/d/1tVTppe4-3Hykug7NrOJrBJT4OXuNOiDO/view?usp=sharing">here</a>. </p>
<p>If you don’t know how to load an Android Image in autopsy, found this <a href="https://www.digitalforensics.com/blog/forensic-analysis-of-an-android-logical-image-with-autopsy/">blog post</a> and followed that and loaded the image in Autopsy.</p>
<p>After loading the android image in autopsy, on checking the files present on the device, I found something intersting in Downloads folder(<code>/data/media/0/Download</code>).</p>
<p><img src="autopsy_downloads.png" alt=""></p>
<p>This seems to the required hosts file, Normally it won’t be stored in any local folder, So to confirm I searched for the hosts file location in android device.</p>
<h2 id="Retrieving-hosts-file"><a href="#Retrieving-hosts-file" class="headerlink" title="Retrieving hosts file"></a>Retrieving hosts file</h2><p>Upon seaching for the hosts file location, got hit, saying that it will be stored in <code>/device/system/etc/system</code>.</p>
<p><img src="hosts_location_net.png" alt=""></p>
<p>When I checked it, etc folder is not there in the mentioned location.</p>
<p><img src="system_etc_system.png" alt=""></p>
<p>Upon searching and got an another hit saying that it will be stored in <code>adb</code> folder of the image. </p>
<blockquote>
<p>Location: /adb/modules/hosts/system/etc/hosts</p>
</blockquote>
<p><img src="adb.png" alt=""></p>
<p>In the same way I am not able to view the metadata on Autopsy for that file.</p>
<p>As I have extracted the tar file, I went to that location and viewed the metadata of that file.</p>
<p><img src="metadata_hosts.png" alt=""></p>
<p>Upon converting the timestamp <code>‎05 ‎March ‎2020, ‏‎11.20.18 AM</code> from IST to UTC, we get <code>‎05 ‎March ‎2020, ‏‎05.50.18 AM</code></p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><blockquote>
<p>03/05/2020 05:58:18</p>
</blockquote>
]]></content>
      <categories>
        <category>Mobile  Forensics</category>
      </categories>
      <tags>
        <tag>Autopsy</tag>
        <tag>Magnet Weekly CTF</tag>
        <tag>Android Forensics</tag>
      </tags>
  </entry>
  <entry>
    <title>PIP Install - Week 2 - Magnet Weekly CTF</title>
    <url>/Magnet-Weekly-CTF/PIP-Install-Week-2-Magnet-Weekly-CTF/</url>
    <content><![CDATA[<p>We are gonna use the Android Image that we examined last week for the “file that maps IPs to names recently accessed”. You can download the image <a href="https://drive.google.com/file/d/1tVTppe4-3Hykug7NrOJrBJT4OXuNOiDO/view?usp=sharing">here</a>.</p>
<p>Week 2 challenge is involved on applications capability and application usage. Let us get started!</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p>What domain was most recently viewed via an app that has picture-in-picture capability?</p>
</blockquote>
<p>For this weeks challenge, I am gonna use Alexis Brignoni’s <a href="https://github.com/abrignoni/ALEAPP">ALEAPP</a>.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>During the announcement of Week 2 challenge it was mentioned about a <a href="https://www.magnetforensics.com/resources/google-where-do-you-store-data-analysis-of-data-storage-between-android-and-google-takeout/">webinar</a> that Tarah Melton and Jessica Hyde had early this year on different data that can be found in Google Takeout and an Android Image. In the end of the webinar Jessica Hyde show us that, when we change an application the snapshots will be stored on the device.</p>
<p>And I found a site that <a href="https://nokiapoweruser.com/list-apps-support-oreo-picture-picture-mode-enable/">listed out all the applications</a> that supported Picture In Picture capability, and it turned out only a few have it.</p>
<h2 id="Firing-up-ALEAPP"><a href="#Firing-up-ALEAPP" class="headerlink" title="Firing up ALEAPP"></a>Firing up ALEAPP</h2><p>On firing Up ALEAPP, it creates a nice HTML report in the mentioned directory mentioned.</p>
<p><img src="aleapp.png" alt=""></p>
<p>On going through the reports generated by ALEAPP, it created a report for “Recent Activity, Snanpshots”. And the last accessed UPL from the browser according to the snapshot is <code>http://malliesae[.]com/investor-page/</code>. </p>
<p><img src="chrome_snapshot.jpg" alt=""></p>
<p><img src="snapshot.png" alt=""></p>
<p>From my personal experience, Chrome supports Picture In Picture capability, And on checking the Chrome History report generated by ALEAPP and sorting it out to most recently accessed URLs, it gave <code>http://malliesae[.]com/investor-page/</code> accessed at <code>2020-03-23 23:53:22</code></p>
<p><img src="chromehistory.png" alt=""></p>
<p>As chrome is having PIP capability and <code>malliesae[.]com</code> is the most recently accessed domain, let head on to submit it. And its correct!</p>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><blockquote>
<p><strong>malliesae.com</strong></p>
</blockquote>
]]></content>
      <categories>
        <category>Mobile Forensics</category>
      </categories>
      <tags>
        <tag>Magnet Weekly CTF</tag>
        <tag>Android Forensics</tag>
        <tag>ALEAP</tag>
        <tag>Picture-In-Picture</tag>
      </tags>
  </entry>
  <entry>
    <title>Week 9 - Magnet Weekly CTF</title>
    <url>/Magnet-Weekly-CTF/Week-9-Magnet-Weekly-CTF/</url>
    <content><![CDATA[<p>This week’s Memory Forensics challenge is divided into 7 really interesting parts. You can download the memory image <a href="https://drive.google.com/drive/folders/1iCxOKhfoHvxoBRNXJlm2VBiAVgDD_p5d?usp=sharing">here</a>.</p>
<p>If you are new to Memory Forensics, you can check out <a href="https://github.com/stuxnet999/Memlabs">Memlabs</a> created by <a href="https://www.twitter.com/_abhiramkumar">Abhiram Kumar</a>. Here are my <a href="https://bolisettynihith.github.io/categories/Memlabs/">writeups</a> for the same.</p>
<h2 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h2><p>We are provided with a Windows memory dump. I’ll we be using <strong>Volatility</strong> to analyze and some command-line tools for extracting the relevant answers.</p>
<h3 id="Finding-Profile"><a href="#Finding-Profile" class="headerlink" title="Finding Profile"></a>Finding Profile</h3><p>We shall use the plugin <strong>imageinfo</strong> to find the profile for the memory dump.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem imageinfo</code></pre>
<p><img src="profile.png" alt="Profile for the memory image"></p>
<p>So let us use the profile as <strong>Win7SP1x64</strong></p>
<h2 id="Answering-Part-1"><a href="#Answering-Part-1" class="headerlink" title="Answering Part - 1"></a>Answering Part - 1</h2><h3 id="Descripton"><a href="#Descripton" class="headerlink" title="Descripton"></a>Descripton</h3><blockquote>
<p>The user had a conversation with themselves about changing their password. What was the password they were contemplating changing too. Provide the answer as a text string.</p>
</blockquote>
<p>As the description talks about a conversation, it might be saved as plain text on the memory dump. So let us use the <code>strings</code> command and <code>grep</code> for the string <code>password</code> over the memory dump.</p>
<pre class=" language-bash"><code class="language-bash">$ strings memdump.mem <span class="token operator">|</span> <span class="token function">grep</span> -i password
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
Hmmm mmaybe I should change my password to:
wow_this_is_an_uncrackable_password
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span></code></pre>
<p>Here is the interesting thing, we got the password.</p>
<h3 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h3><p><code>wow_this_is_an_uncrackable_password</code></p>
<h2 id="Answering-Part-2"><a href="#Answering-Part-2" class="headerlink" title="Answering Part - 2"></a>Answering Part - 2</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the md5 hash of the file which you recovered the password from?</p>
</blockquote>
<p>So now comes the real part, what is md5sum of the file that they had a conversation with themselves. Where is this file located on the memory image? To find that out, we need to know which application, the user is using for opening this file.</p>
<p>As we already got the password string, Let us use <code>yarascan</code>.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem --profile<span class="token operator">=</span>Win7SP1x64 yarascan -Y <span class="token string">"wow_this_is_an_uncrackable_password"</span></code></pre>
<p><img src="yarascan.png" alt="yarascan output"></p>
<p>From the above image, we can see the application as <code>WINWORD.EXE</code> with PID <code>3180</code> and the Virtual Offset where the password string is stored on the application memory is found at <code>0x02180a2d</code>.</p>
<p>Upon searching for the document files(.doc or .docx) in files, nothing found useful. So let’s try out the <code>handles</code> plugin as it will give us all the open handles for a process. </p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem --profile<span class="token operator">=</span>Win7SP1x64 handles -p 3180 -t File
Volatility Foundation Volatility Framework 2.6
Offset<span class="token punctuation">(</span>V<span class="token punctuation">)</span>             Pid             Handle             Access Type             Details
------------------ ------ ------------------ ------------------ ---------------- -------
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
0xfffffa80326de810   3180              0x9c4           0x12019f File             \Device\HarddiskVolume1\Users\Warren\AppData\Roaming\Microsoft\Word\AutoRecovery save of Document1.asd
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span></code></pre>
<p>We can see an open handle for <code>AutoRecovery save of Document1.asd</code> file and upon opening it we got the conversation that the user had with themselves.</p>
<pre class=" language-text"><code class="language-text">Hmmm mmaybe I should change my password to: “wow_this_is_an_uncrackable_password”

Great idea warren

Thank you warren

You’re so smart warren

I know I am Warren</code></pre>
<p>Now we got the file, the application in which the user opened this file, and the virtual offset for the password string.</p>
<p>According to the description, we need the md5 sum of this file.</p>
<pre class=" language-bash"><code class="language-bash">$ md5sum AutoRecovery\ save\ of\ Document1.asd
af1c3038dca8c7387e47226b88ea6e23  AutoRecovery save of Document1.asd</code></pre>
<h3 id="Flag-1"><a href="#Flag-1" class="headerlink" title="Flag"></a>Flag</h3><p><code>af1c3038dca8c7387e47226b88ea6e23</code></p>
<h2 id="Answering-Part-3"><a href="#Answering-Part-3" class="headerlink" title="Answering Part - 3"></a>Answering Part - 3</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the birth object ID for the file which contained the password?</p>
</blockquote>
<p>As we already got the filename, we can use the <code>mftparser</code> plugin and get the <code>Birth Object ID</code>.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem --profile<span class="token operator">=</span>Win7SP1x64 mftparser --output-file<span class="token operator">=</span>mftparser.txt</code></pre>
<p>Upon greping for the filename in <code>mftparser.txt</code>, here is what we got</p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">grep</span> -A 10 <span class="token string">'AutoRecovery save of Document1.asd'</span> mftparser.txt

2020-04-20 23:22:36 UTC+0000 2020-04-20 23:22:36 UTC+0000   2020-04-20 23:22:36 UTC+0000   2020-04-20 23:22:36 UTC+0000   Users\Warren\AppData\Roaming\MICROS~1\Word\AutoRecovery save of Document1.asd

<span class="token variable">$DATA</span>


<span class="token variable">$OBJECT_ID</span>
Object ID: 40000000-0000-0000-0060-000000000000
Birth Volume ID: 005a0000-0000-0000-0056-000000000000
Birth Object ID: 31013058-7f31-01c8-6b08-210191061101
Birth Domain ID: f81101e8-3101-3d66-f800-000000000000</code></pre>
<p>So we got the birth object id, so we got the flag.</p>
<h3 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag"></a>Flag</h3><p><code>31013058-7f31-01c8-6b08-210191061101</code></p>
<h2 id="Answering-Part-4"><a href="#Answering-Part-4" class="headerlink" title="Answering Part - 4"></a>Answering Part - 4</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the name of the user and their unique identifier which you can attribute the creation of the file document to?</p>
<p>Format: #### (Name)</p>
</blockquote>
<p>Now we need to find the owner of this file and the Unique identifier for the owner of this file.<br>We can get these details, by using the <code>getsids</code> plugin to find the owner of this process that eventually gives the owner of this file.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem --profile<span class="token operator">=</span>Win7SP1x64 getsids <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'WINWORD.EXE\|3180'</span>

WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-21-4288132831-552422005-3632184702-1000 <span class="token punctuation">(</span>Warren<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-21-4288132831-552422005-3632184702-513 <span class="token punctuation">(</span>Domain Users<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-1-0 <span class="token punctuation">(</span>Everyone<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-114 <span class="token punctuation">(</span>Local Account <span class="token punctuation">(</span>Member of Administrators<span class="token punctuation">))</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-32-544 <span class="token punctuation">(</span>Administrators<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-32-545 <span class="token punctuation">(</span>Users<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-4 <span class="token punctuation">(</span>Interactive<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-2-1 <span class="token punctuation">(</span>Console Logon <span class="token punctuation">(</span>Users <span class="token function">who</span> are logged onto the physical console<span class="token punctuation">))</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-11 <span class="token punctuation">(</span>Authenticated Users<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-15 <span class="token punctuation">(</span>This Organization<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-113 <span class="token punctuation">(</span>Local Account<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-5-0-691206 <span class="token punctuation">(</span>Logon Session<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-2-0 <span class="token punctuation">(</span>Local <span class="token punctuation">(</span>Users with the ability to log <span class="token keyword">in</span> locally<span class="token punctuation">))</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-5-64-10 <span class="token punctuation">(</span>NTLM Authentication<span class="token punctuation">)</span>
WINWORD.EXE <span class="token punctuation">(</span>3180<span class="token punctuation">)</span>: S-1-16-12288 <span class="token punctuation">(</span>High Mandatory Level<span class="token punctuation">)</span></code></pre>
<p>From the 1st line in the above text, we can confirm that the Unique Identifier is <code>1000</code> and the User/Owner of this process as <code>Warren</code>.</p>
<h3 id="Flag-3"><a href="#Flag-3" class="headerlink" title="Flag"></a>Flag</h3><p><code>1000 (Warren)</code></p>
<h2 id="Answering-Part-5"><a href="#Answering-Part-5" class="headerlink" title="Answering Part - 5"></a>Answering Part - 5</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the version of software used to create the file containing the password?</p>
<p>Format ## (Whole version number, don’t worry about decimals)</p>
</blockquote>
<p>I think there are a lot of ways to get the version of the software used to create the file containing the password.<br>I followed this, we can use the <code>procdump</code> plugin and dump the <code>WINWORD.EXE</code> and examining it gives the version of the software.</p>
<pre class=" language-bash"><code class="language-bash">$ volatility -f memdump.mem --profile<span class="token operator">=</span>Win7SP1x64 procdump -p 3180 -D dump
Volatility Foundation Volatility Framework 2.6
Process<span class="token punctuation">(</span>V<span class="token punctuation">)</span>         ImageBase          Name                 Result
------------------ ------------------ -------------------- ------
0xfffffa803177bb00 0x000000013f9f0000 WINWORD.EXE          OK: executable.3180.exe</code></pre>
<p>Now we got the executable. we can now proceed and check the <code>little-endian</code> strings of this executable.</p>
<pre class=" language-bash"><code class="language-bash">$ strings -el dump/executable.3180.exe
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
StringFileInfo
000004E4
CompanyName
Microsoft Corporation
FileDescription
Microsoft Word
FileVersion
15.0.5233.1000
InternalName
WinWord
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span></code></pre>
<p>We got the version of the software used to create the file containing the password.</p>
<h3 id="Flag-4"><a href="#Flag-4" class="headerlink" title="Flag"></a>Flag</h3><p><code>15</code></p>
<h2 id="Answering-Part-6"><a href="#Answering-Part-6" class="headerlink" title="Answering Part - 6"></a>Answering Part - 6</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the virtual memory address offset where the password string is located in the memory image?</p>
<p>Format: 0x########</p>
</blockquote>
<p>While answering part -2, yarascan gives the output from an application perspective, so we can use that address as the virtual address.</p>
<h3 id="Flag-5"><a href="#Flag-5" class="headerlink" title="Flag"></a>Flag</h3><p><code>0x02180a2d</code></p>
<h2 id="Answering-Part-7"><a href="#Answering-Part-7" class="headerlink" title="Answering Part - 7"></a>Answering Part - 7</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><blockquote>
<p>What is the physical memory address offset where the password string is located in the memory image?</p>
<p>Format: 0x#######</p>
</blockquote>
<p>We need the offset from the memory perspective, so let us load the memory image into a hex editor and search for our password.</p>
<p><img src="part7.png" alt="Memory dump loaded in HxD"></p>
<p>At the bottom of the image, you can see the offset where our password string started and we can use that as a physical memory address.</p>
<h3 id="Flag-6"><a href="#Flag-6" class="headerlink" title="Flag"></a>Flag</h3><p><code>0x0AF12A2D</code></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Volatility Command reference: <a href="https://github.com/volatilityfoundation/volatility/wiki/Command-Reference">https://github.com/volatilityfoundation/volatility/wiki/Command-Reference</a></li>
</ul>
]]></content>
      <categories>
        <category>Memory Forensics</category>
      </categories>
      <tags>
        <tag>Volatility</tag>
        <tag>Memory</tag>
        <tag>Magnet Weekly CTF</tag>
      </tags>
  </entry>
</search>
